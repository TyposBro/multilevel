Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Введение
Введение
Payme Business – Верный помощник для вашего бизнеса.

Став партнером, вы сможете принимать оплаты c банковских карт Uzcard и HUMO за ваши товары и услуги в режиме онлайн по средству мобильного приложения Payme, ТГ ботов, электронной почте или SMS.

к сведению
Деньги поступают на расчётный счёт бизнеса через кассы Payme BUSINESS.

У Payme BUSINESS 3 вида касс:

Касса для приёма платежей с биллингом.

Касса для приёма платежей без биллинга.

Касса для приёма оплаты на месте.

Касса для приёма оплаты на месте позволяет начать принимать оплату сразу после подключения.

Касса для приёма платежей с биллингом и касса для приёма платежей без биллинга требуют настройки взаимодействия приложения с Payme BUSINESS.

к сведению
С кассами могут работать только юридические лица: ИП, ЧП, ООО, АО, ГУП, СП, НОУ.

Следующая страница
Настройка взаимодействия

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Настройка взаимодействия
Настройка взаимодействия
Касса для приёма оплаты на месте позволяет начать принимать оплату сразу после подключения.

Касса для приёма платежей без биллинга и касса для приёма платежей с биллингом требуют настройки взаимодействия приложения мерчанта с Payme BUSINESS.

Payme BUSINESS взаимодействует с приложением мерчанта с помощью запросов и ответов по протоколу удаленного вызова процедур JSON-RPC 2.0. Запросы и ответы отправляются по протоколам: Merchant API и Subscribe API.

Протокол Merchant API обеспечивает:

полный контроль над транзакциями;

возможность гарантированной отмены платежа;

распределение оплаты между владельцем приложения и бизнес-партнерами.

к сведению
Протокол Merchant API удобно использовать когда вы принимаете оплату с помощью стандартной платёжной формы Payme.

Протокол Subscribe API позволяет:

привязать карту клиента к сервису, например, чтобы принимать оплату «в один клик»;

оплачивать товары и/или услуги без перехода на платёжную страницу Payme;

принимать регулярные платежи и автоплатежи;

выставлять счета за товары и/или услуги.

к сведению
Протокол Subscribe API удобно использовать, когда вы принимаете оплату с помощью собственной платёжной формы, генерируете собственные чеки, отправляете инвойсы.

Протоколы отличаются способом взаимодействия приложения мерчанта с Payme BUSINESS:

В протоколе Merchant API запросы отправляет Payme Business, а ответы и информацию об ошибках отправляет приложение мерчанта.

В протоколе Subscribe API запросы отправляет приложение мерчанта, а ответы и информацию об ошибках отправляет Payme Business.

Порядок настройки взаимодействия:

Настройте взаимодействие приложения с Payme BUSINESS по протоколу Merchant API и/или Subscribe API.

Протестируйте взаимодействие приложения с Payme BUSINESS в песочнице.

Добавьте в приложение способ инициализации платежей (способ создания чека).

Перенесите реализованное взаимодействие на рабочий сервер.

Предыдущая страница
Введение
Следующая страница
Протокол Merchant API


Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Протокол Merchant API
Протокол Merchant API
Payme Business взаимодействует с биллингом мерчанта с помощью запросов и ответов по протоколу удалённого вызова процедур JSON-RPC 2.0. Запросы передаются по протоколу HTTP 1.1 методом POST и упаковываются в криптографический протокол TLS (HTTPS). Запросы содержат только именованные параметры.

к сведению
Для улучшения безопасности передачи данных рекомендуем использовать протокол HTTPS.

Требования

Для работы с Merchant API, сервер мерчанта должен поддерживать любую из трёх версий криптографического TLS протокола:
TLS v1;

TLS v1.1;

TLS v1.2.

Ответы с сервера мерчанта должны возвращаться с HTTP-статусом 200. Статусы отличные от 200 воспринимаются как RPC-ошибка: -32400
Предыдущая страница
Настройка взаимодействия
Следующая страница
Формат запроса

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Протокол Merchant APIФормат запроса
Формат запроса
Все сообщения поступают в биллинг мерчанта в виде RPC-запроса. RPC-запрос это JSON объект с полями: method, params, id.

Имя	Тип	Описание
method	String	Имя метода.
params	Object	Параметры метода.
id	Integer	Идентификатор запроса.
Пример RPC-запроса

POST https://merchant/pay/ HTTP/1.1
Content-Type: text/json; charset=UTF-8
Authorization: Basic TG9naW46UGFzcw==

{
    "method" : "PerformTransaction",
    "params" : {
        "id" : "53327b3fc92af52c0b72b695",
        "time" : 1399114284039,
        "amount" : 500000,
        "account" : {
            "phone" : "903595731"
        },
    },
    "id" : 2032
}

Предыдущая страница
Протокол Merchant API
Следующая страница
Формат ответа

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Протокол Merchant APIФормат ответа
Формат ответа
Все сообщения возвращаются из биллинга мерчанта в виде RPC-ответа. RPC-ответ это JSON объект с полями: result или error и id.

Когда метод выполнен успешно, RPC-ответ содержит поля:

Имя	Тип	Описание
result	Object	Результат выполнения метода. Поле отсутствует если выполнение метода завершилось ошибкой.
id	Integer	Идентификатор ответа — соответствует идентификатору запроса.
Пример успешного RPC-ответа

HTTP/1.1 200 OK
Content-Type: text/json; charset=UTF-8

{
    "result" : {
        "id" : "1288",
        "time" : 1399114284039,
        "receivers" : [
            {
                "id" : "5305e3bab097f420a62ced0b",
                "amount" : 500000
            }
        ]
    },
    "id" : 2032
}

Если выполнение метода завершилось ошибкой, RPC-ответ содержит поля:

Имя	Тип	Описание
error	Error	Поле с описанием ошибки. Поле отсутствует если выполнение метода завершилось успешно.
id	Integer	Идентификатор ответа — соответствует идентификатору запроса.
Структура ошибки (Error)

Имя	Тип	Описание
code	Integer	Код ошибки.
message	Object	Локализованный текст сообщения об ошибке. Сообщение выводится пользователю.
data	Object	Дополнительные сведения об ошибке.
Пример ответа, содержащего информацию об ошибке

HTTP/1.1 200 OK
Content-Type: text/json; charset=UTF-8

{
    "error" : {
        "code" : -31050,
        "message" : {
            "ru" : "Номер телефона не найден",
            "uz" : "Raqam ro'yhatda yo'q",
            "en" : "Phone number not found"
        },
        "data" : "phone"
    },
    "id" : 2032
}

Предыдущая страница
Формат запроса
Следующая страница
Общие ошибки

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Протокол Merchant APIОбщие ошибки
Общие ошибки
Code	Description
-32300	Ошибка возникает в том случае, если метод запроса не POST.
-32700	Ошибка парсинга JSON.
-32600	В RPC-запросе отсутствуют обязательные поля или тип полей не соответствует спецификации.
-32601	Запрашиваемый метод не найден. В RPC-запросе имя запрашиваемого метода содержится в поле data.
-32504	Недостаточно привилегий для выполнения метода.
-32400	Системная (внутренняя ошибка). Ошибку следует использовать в случае системных сбоев: отказа базы данных, отказа файловой системы, неопределенного поведения и т.д.
к сведению
Ошибки, которые возвращает определённый метод, смотрите в описании самого метода.

Предыдущая страница
Формат ответа
Следующая страница
Схема взаимодействия

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Протокол Merchant APIСхема взаимодействия
Схема взаимодействия
Авторизация Payme Business в биллинге мерчанта

Payme Business отправляет запросы в биллинг мерчанта только со следующих ip-адресов:

185.234.113.1
185.234.113.2
185.234.113.3
185.234.113.4
185.234.113.5
185.234.113.6
185.234.113.7
185.234.113.8
185.234.113.9
185.234.113.10
185.234.113.11
185.234.113.12
185.234.113.13
185.234.113.14
185.234.113.15
Payme Business не использует другие ip-адреса для отправки запросов.

Для авторизации Payme Business в биллинге мерчанта используется «Базовая HTTP-аутентификация».

Для HTTP-сервера рекомендуется выставить настройки:

ssl session cache = 1 мегабайт

ssl session timeout = 10 минут или больше

keepalive timeout = 10 минут

Payme Business передаёт логин и пароль в HTTP заголовке Authorization .

Формат заголовка: Basic base64(login:password)

Пример заголовка

Authorization: Basic TG9naW46UGFzcw==

login: password: <строка длиной 36 символов>

Login - запросите у технического специалиста Payme Business.

Password - ключ, он выдаётся мерчанту после добавления веб-кассы.

Сценарий проведения финансовой транзакции



Сценарий проведения финансовой транзакции

Payme Business создаёт финансовую транзакцию

Приложение:

2.1. Проверяет сумму платежа.

2.2. Проверяет параметры транзакции.

2.3. Записывает транзакцию в базу данных.

2.4. Бронирует заказ и устанавливает у заказа статус «ожидание оплаты».

2.5. Возвращает список получателей — продавцам принимающим адаптивные платежи.

Payme Business проводит дебетовые операции по всем получателям.

Процессинговый центр подтверждает успешное проведение операций.

Payme Business завершает транзакцию.

Приложение фиксирует платежи в биллинге и подтверждает завершение транзакции.

Потеря ответа при создании транзакции



Для создания транзакции сервис Payme Business вызывает метод CreateTransaction. В случае потери ответа при вызове метода, Payme Business повторяет запрос с теми же параметрами.

Ошибка при совершении дебетовой операции



Если во время проведения дебетовых операций возникает ошибка, Payme Business отменяет транзакцию. Для отмены транзакции Payme Business вызывает метод CancelTransaction.

Ошибка проведения транзакции



Чтобы завершить транзакцию, Payme Business вызывает метод Perform Transaction. В случае потери ответа, при вызове метода, Payme Business повторяет запрос с теми же параметрами.

Если Payme Business в течении длительного времени не получает ответа от приложения, процесс оплаты приостанавливается и управление транзакцией производится в ручном режиме. Управляет транзакцией сотрудник Payme Business.

Предыдущая страница
Общие ошибки
Следующая страница
Методы Merchant API

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Merchant API
Методы Merchant API
CheckPerformTransaction. Проверка возможности создания финансовой транзакции

CreateTransaction. Создание финансовой транзакции

PerformTransaction. Проведение финансовой транзакции

CancelTransaction. Отмена финансовой транзакции

CheckTransaction. Проверка состояния финансовой транзакции

GetStatement. Информация о транзакциях мерчанта

Предыдущая страница
Схема взаимодействия
Следующая страница
CheckPerformTransactionПерейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Merchant APICheckPerformTransaction
CheckPerformTransaction
Если оплата возможна — метод CheckPerformTransaction возвращает результат allow. Если оплата невозможна — метод возвращает ошибку.



На этапе проверки возможности проведения транзакции, рекомендуется проверить все системы задействованные при выполнении методов: CreateTransaction и PerformTransaction. Если нарушена работа хотя бы одной из задействованных систем, то при выполнении вышеуказанных методов необходимо вернуть ошибку -32400 (Системная ошибка).

Параметры запроса

Имя	Тип	Описание
amount	Amount	Сумма платежа (в тийинах).
account	Account	Счет потребителя услуг.
Пример запроса

{
    "method" : "CheckPerformTransaction",
    "params" : {
        "amount" : 500000,
        "account" : {
            "phone" : "903595731"
        }
    }
}

Параметры ответа

Имя	Тип	Описание
allow	Boolean	Если флаг true, транзакция может быть проведена. В других случаях метод возвращает ошибки: -31001; -31050 — -31099.
Пример ответа

{
    "result" : {
        "allow" : true
    }
}

Коды ошибок

Код	Описание
-31001	Неверная сумма.
-31050 - -31099	Ошибки связанные с неверным пользовательским вводом “account“. Например: введённый логин не найден, введённый номер телефона не найден и т.д. Локализованное поле “message“ обязательно. Поле “data“ должно содержать название субполя “account“.
Добавление объекта additional

{
    "result": {
        "allow": true,
        "additional": {
            "field_name": "field_value"
        }
    }
}

В объекте additional биллинг поставщика может возвращать дополнительную информацию (баланс пользователя, данные о заказе). Кроме того, добавляя объект additional, следует сообщить об этом техническому специалисту Payme Business.

Добавление объекта detail

{
    "result": {
        "allow": true,
        "additional": {
            "field_name": "field_value"
        },
        "detail": {
            "receipt_type" : 0, //тип фискального чека            
            "shipping": { //доставка, необязательное поле
                "title": "Доставка до ттз-4 28/23",
                "price": 500000
            },
            "items": [ //товарная позиция, обязательное поле для фискализации
                {
                    "discount":10000, //Скидка с учетом количества товаров или услуг в тийинах
                    "title": "Помидоры", //нааименование товара или услуги
                    "price": 505000, //цена за единицу товара или услуги, сумма указана в тийинах
                    "count": 2, //кол-во товаров или услуг
                    "code": "00702001001000001", // код *ИКПУ обязательное поле
                    "units": 241092, //значение изменится в зависимости от вида товара
                    "vat_percent": 15, //обязательное поле, процент уплачиваемого НДС для данного товара или услуги
                    "package_code": "123456" //Код упаковки для конкретного товара или услуги, содержится на сайте в деталях найденного ИКПУ.
                }
            ]
        }
    }
}


В объекте detail есть возможность передавать данные о товаре или услуге для фискализации чеков

Имя	Тип	Описание	Обязательное поле
receipt_type	Number	Продажа/Возврат = 0	да
shipping	Object	Доставка	нет
items	Array	Товарная позиция	да
Параметры массива items

Имя	Тип	Описание	Обязательное поле
discount	Number	Скидка с учетом количества товаров или услуг в тийинах	нет
title	String	Название продукта	да
price	Number	Цена за единицу товара или услугу в тийинах	да
count	Number	Количество товаров или услуг	да
code	String	ИКПУ (идентификационный код продукции и услуг)	да
units	Number	Код единицы измерения	нет
package_code	String	Код упаковки продукта	да
vat_percent	Number	Процент уплачиваемого НДС для данного товара	да
Предыдущая страница
Методы Merchant API
Следующая страница
CreateTransaction

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Merchant APICreateTransaction
CreateTransaction
Метод CreateTransaction возвращает список получателей платежа. Когда инициатор платежа является получателем, поле receivers можно опустить или присвоить ему значение NULL.

Если транзакция уже создана, приложение мерчанта производит базовую проверку транзакции и возвращает результат проверки в Payme Business.



Требования к реализации метода

Хранить транзакции следует в постоянном хранилище.

Следует проверять наличие счёта плательщика в поле account. Если счет плательщика не найден — следует возвращать ошибку (-31050 — -31099).

Следует проверять соответствие суммы платежа сумме выставленного счёта.

Следует бронировать заказ покупателя и все входящие в него товары до оплаты или отмены по таймауту.

Следует исключить возможность изменения заказа покупателем.

У неоплаченных заказов следует установить статус “ожидание оплаты”.

Отмена по таймауту

Отмена транзакции по таймауту производится через 12 часов — 43 200 000 миллисекунд с момента создания транзакции в Payme Business. После отмены по таймауту транзакция переходит в состояние: “Транзакция отменена” (-1), с причиной: “Отмена по таймауту” (4).

Параметры запроса

Имя	Тип	Описание
id	ID	Идентификатор транзакции Payme Business.
time	Timestamp	Время создания транзакции Payme Business.
amount	Amount	Сумма платежа (в тийинах).
account	Account	Счет потребителя услуг.
Пример запроса

{
    "method" : "CreateTransaction",
    "params" : {
        "id" : "5305e3bab097f420a62ced0b",
        "time" : 1399114284039,
        "amount" : 500000,
        "account" : {
            "phone" : "903595731"
        }
    }
}

Параметры ответа

Имя	Тип	Описание
create_time	Timestamp	Время создания транзакции в системе мерчанта.
transaction	String	Номер или идентификатор транзакции в системе мерчанта. Формат строки определяется мерчантом.
state	State	Состояние транзакции.
receivers	Receiver[ ]	Список получателей. Необязательный параметр. В случае если владелец приложения является получателем, поле можно опустить или присвоить ему значение NULL.
Пример ответа

//Прямой платеж
//все средства поступят на счет владельца приложения

{
    "result" : {
        "create_time" : 1399114284039,
        "transaction" : "5123",
        "state" : 1
    }
}

//Цепной платеж
//на счет владельца поступит 2тыс сум,
//на счет другого поставщика поступит 3тыс сум

{
    "result" : {
        "create_time" : 1399114284039,
        "transaction" : "5123",
        "state" : 1,
        "receivers" : [
            {
                "id" : "5305e3bab097f420a62ced0b",
                "amount" : 200000
            },
            {
                "id" : "4215e6bab097f420a62ced01",
                "amount" : 300000
            }
        ]
    }
}

Коды ошибок

Код	Описание
-31001	Неверная сумма.
-31008	Невозможно выполнить операцию.
-31050 — -31099	Ошибки неверного ввода данных покупателем account, например: не найден введёный логин, не найден введенный номер телефона и т.д. Локализованное поле message обязательно. Поле data должно содержать название субполя account.
Предыдущая страница
CheckPerformTransaction
Следующая страница
PerformTransaction

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Merchant APIPerformTransaction
PerformTransaction
Метод PerformTransaction зачисляет средства на счет мерчанта и выставляет у заказа статус «оплачен».



Параметры запроса

Имя	Тип	Описание
id	ID	Идентификатор транзакции Payme Business.
Пример запроса

{
    "method" : "PerformTransaction",
    "params" : {
        "id" : "5305e3bab097f420a62ced0b"
    }
}

Параметры ответа

Имя	Тип	Описание
transaction	String	Номер или идентификатор транзакции в биллинге мерчанта. Формат строки определяется мерчантом.
perform_time	Timestamp	Время проведения транзакции в биллинге мерчанта.
state	State	Состояние транзакции.
Пример ответа

{
    "result" : {
        "transaction" : "5123",
        "perform_time" : 1399114284039,
        "state" : 2
    }
}

Коды ошибок

Код	Описание
-31003	Транзакция не найдена
-31008	Невозможно выполнить данную операцию. (см. диаграмму)
-31050 — -31099	Ошибки неверного ввода данных покупателем account, например: не найден введёный логин, не найден введенный номер телефона и т.д. Локализованное поле message обязательно. Поле data должно содержать название субполя account.
Предыдущая страница
CreateTransaction
Следующая страница
CancelTransaction

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Merchant APICancelTransaction
CancelTransaction
Метод CancelTransaction отменяет как созданную, так и проведенную транзакцию.



Параметры запроса

Имя	Тип	Описание
id	ID	Идентификатор транзакции Payme Business.
reason	Reason	Причина отмены транзакции.
Пример запроса

{
    "method" : "CancelTransaction",
    "params" : {
        "id" : "5305e3bab097f420a62ced0b",
        "reason" : 1
    }
}

Параметры ответа

Имя	Тип	Описание
transaction	String	Номер или идентификатор транзакции в биллинге мерчанта. Формат строки определяется мерчантом.
cancel_time	Timestamp	Время отмены транзакции.
state	State	Состояние транзакции
Пример ответа

{
    "result" : {
        "transaction" : "5123",
        "cancel_time" : 1399114284039,
        "state" : -2
    }
}

Коды ошибок

Код	Описание
-31003	Транзакция не найдена.
-31007	Заказ выполнен. Невозможно отменить транзакцию. Товар или услуга предоставлена покупателю в полном объеме.
Возврат денег покупателю

Если по каким-либо причинам покупатель не получил оплаченный банковской картой товар или передумал его приобретать, мерчант возвращает деньги покупателю в личном кабинете мерчанта.

Возврат денег покупателю возможен только если реализован метод CancelTransaction.

Предыдущая страница
PerformTransaction
Следующая страница
CheckTransaction

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Merchant APICheckTransaction
CheckTransaction
Параметры запроса

Имя	Тип	Описание
id	ID	Идентификатор транзакции Payme Business
Пример запроса

{
    "method" : "CheckTransaction",
    "params" : {
        "id" : "5305e3bab097f420a62ced0b"
    }
}

Параметры ответа

Имя	Тип	Описание
create_time	Timestamp	Время добавления транзакции в биллинге мерчанта.
perform_time	Timestamp	Время проведения транзакции в биллинге мерчанта.
cancel_time	Timestamp	Время отмены транзакции в биллинге мерчанта.
transaction	String	Номер или идентификатор транзакции в биллинге мерчанта. Формат строки определяется мерчантом.
state	State	Состояние транзакции.
reason	Reason	Причина завершения транзакции или null.
Пример ответа

{
    "result" : {
        "create_time" : 1399114284039,
        "perform_time" : 1399114285002,
        "cancel_time" : 0,
        "transaction" : "5123",
        "state" : 2,
        "reason" : null
    }
}

Коды ошибок

Код	Описание
-31003	Транзакция не найдена.
Предыдущая страница
CancelTransaction
Следующая страница
GetStatement

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Merchant APIGetStatement
GetStatement
Информация о транзакциях используется для актов сверки транзакций мерчанта и Payme Business.

Чтобы вернуть список транзакций за указанный период используется метод GetStatement.

к сведению
Реализация метода GetStatement обязательна!

Требования к реализации метода:

Поиск транзакций следует осуществлять по дате создания транзакции в системе Payme Business. Дату создания транзакции передаёт метод CreateTransaction.

В список должны попасть все транзакции, которые были созданы после удачного выполнения метода CreateTransaction. В список не должны попасть транзакции при создании которых выполнение метода CreateTransaction завершилось ошибкой.

Список должен содержать транзакции от даты переданной в поле “from” до даты переданной в поле “to” включительно, то есть все транзакции попадающие под условие: from <= time <= to. Транзакции в списке должны быть отсортированы по дате создания в возрастающем порядке. Если за выбранный период нет ни одной транзакции, метод возвращает пустой список.

Параметры запроса

Имя	Тип	Описание
from	Timestamp	Начало периода.
to	Timestamp	Окончание периода.
Пример запроса

{
    "method" : "GetStatement",
    "params" : {
        "from" : 1399114284039,
        "to" : 1399120284000
    }
}

Параметры ответа

Имя	Тип	Описание
transaction	Transaction[ ]	Список транзакций.
Пример ответа

//за период не найдено ни одной транзакции

{
    "result" : {
        "transactions" : []
    }
}

{
    "result" : {
        "transactions" : [
            {
                "id" : "5305e3bab097f420a62ced0b",
                "time" : 1399114284039,
                "amount" : 500000,
                "account" : {
                    "phone" : "903595731"
                },
                "create_time" : 1399114284039,
                "perform_time" : 1399114285002,
                "cancel_time" : 0,
                "transaction" : "5123",
                "state" : 2,
                "reason" : null,
                "receivers" : [
                    {
                        "id" : "5305e3bab097f420a62ced0b",
                        "amount" : 200000
                    },
                    {
                        "id" : "4215e6bab097f420a62ced01",
                        "amount" : 300000
                    }
                ]
            },
            ……
        ]
    }
}

Предыдущая страница
CheckTransaction
Следующая страница
SetFiscalData

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Merchant APISetFiscalData
SetFiscalData
Для получения данных о фискализации чеков, мерчанты которые работают по Merchant API должны на своей стороне реализовать RPC метод SetFiscalData. Через этот метод мерчантам передаются данные о фискализации чека.

к сведению
Данный метод не обязателен к реализации. Запрос посылается в биллинг поставщика, после перехода чека в успешный статус, не зависимо от реализованного протокола

Параметры запроса

Имя	Тип	Описание
id	String	Уникальный id чека в БД Payme
type	String	Тип чека, принимает два значения “PERFORM” и “CANCEL” для чеков оплаты и отмены соответственно
fiscal_data	FiscalData	Данные о фискализации чека
Тип FiscalData

Имя	Тип	Описание
receipt_id	String	Уникальный порядковый номер платежа для Виртуального Фискального Модуля
status_code	Number	Код статуса, ниже приведен список кодов
message	String	Детальная информация об ошибке (если произошла ошибка при регистрации чека в ОФД)
terminal_id	String	Номер Виртуального Фискального Модуля
fiscal_sign	String	Фискальный Признак чека платежа
qr_code_url	String	URL адрес фискального чека
date	String	Дата регистрации чека на стороне ОФД
Пример запроса чека для оплаты

{
    "method": "SetFiscalData",
    "params": {
        "id": "61396aaed8b87a4c215ae556",
        "type": "PERFORM",
        "fiscal_data": {
            "receipt_id": 121,
            "status_code": 0,
            "message": "accepted",
            "terminal_id": "EP000000000025",
            "fiscal_sign": "800031554082",
            "qr_code_url": "fiscal receipt url",
            "date": "20220706221021"
        }
    }
}

Пример запроса чека для отмены

{
    "method": "SetFiscalData",
    "params": {
        "id": "61396aaed8b87a4c215ae556",
        "type": "CANCEL",
        "fiscal_data": {
            "receipt_id": 123,
            "status_code": 0,
            "message": "accepted",
            "terminal_id": "EP000000000025",
            "fiscal_sign": "800031554082",
            "qr_code_url": "fiscal receipt url",
            "date": "20220706221021"
        }
    }
}

Параметры ответа

Имя	Тип	Описание
result	Result	Результат вызова метода, возвращается при успешной обработке данных
error	Error	Объект ошибки, содержит код и сообщение ошибки, возвращается только в случае возникновения ошибок
Тип Result

Имя	Тип	Описание
success	Boolean	При успешной обработке данных принимает значение true. В других случаях метод возвращает ошибки: -32001; -32700; -32602
Тип Error

Имя	Тип	Описание
code	Number	Код ошибки, ниже приведен список кодов
message	String	Описание ошибки
Коды ошибок

Код	Описание
-32001	Чек с таким id не найден
-32700	Отправлен не валидный JSON объект
-32602	Не валидные параметры (что за параметр не валидный указывается в поле message)
Пример успешного ответа

{
    "result": {
        "success": true
    }
}

Пример ответа если возникла ошибка

{
    "error": {
        "code": -32001,
        "message": "Чек с таким id не найден"
    }
}

На стороне ГНК формируется два разных фискальных чеков для чеков оплаты и отмены, поэтому если метод SetFiscalData вызывается с параметром type: “CANCEL“, то необходимо сохранить данные из поле fiscal_ data как отдельный фискальный чек.

Пример

{
    "fiscal": {
        "perform_data": {
            "receipt_id": 121,
            "status_code": 0,
            "message": "accepted",
            "terminal_id": "EP000000000025",
            "fiscal_sign": "800031554082",
            "qr_code_url": "fiscal receipt url",
            "date": "20220706221021"
        },
        "cancel_data": {
            "receipt_id": 123,
            "status_code": 0,
            "message": "accepted",
            "terminal_id": "EP000000000025",
            "fiscal_sign": "900031555055",
            "qr_code_url": "fiscal receipt url",
            "date": "20220706231125"
        }
    }
}

Предыдущая страница
GetStatement
Следующая страница
Ошибки (ERRORS)

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Merchant APIОшибки (ERRORS)
Ошибки (ERRORS)
Общие ошибки

Code	Description
-32300	Ошибка возникает если метод запроса не POST.
-32700	Ошибка парсинга JSON.
-32600	Отсутствуют обязательные поля в RPC-запросе или тип полей не соответствует спецификации.
-32601	Запрашиваемый метод не найден. В RPC-запросе имя запрашиваемого метода содержится в поле data.
-32504	Недостаточно привилегий для выполнения метода.
-32400	Системная (внутренняя ошибка). Ошибку следует использовать в случае системных сбоев: отказа базы данных, отказа файловой системы, неопределенного поведения и т.д.
Ошибки в ответах сервера мерчанта

Код	Описание
-31001	Неверная сумма. Ошибка возникает когда сумма транзакции не совпадает с суммой заказа. Актуальна если выставлен одноразовый счёт.
-31003	Транзакция не найдена.
-31007	Невозможно отменить транзакцию. Товар или услуга предоставлена потребителю в полном объеме.
-31008	Невозможно выполнить операцию. Ошибка возникает если состояние транзакции, не позволяет выполнить операцию.
-31050 - -31099	Ошибки, связанные с неверным пользовательским вводом “account“, например: введенный логин не найден, введенный номер телефона не найден и т.д. В ошибках, локализованное поле “message“ обязательно. Поле “data“ должно содержать название субполя “account“.
Ошибки метода CheckPerformTransaction

Код	Описание
-31001	Неверная сумма.
-31050 - -31099	Ошибки неверного ввода данных покупателем account, например: введенный логин не найден, введенный номер телефона не найден и т.д. Локализованное поле “message“ обязательно. Поле “data“ должно содержать название субполя “account“.
Ошибки метода CreateTransaction

Код	Описание
-31001	Неверная сумма.
-31008	Невозможно выполнить операцию.
-31050 — -31099	Ошибки неверного ввода данных покупателем account, например: не найден введёный логин, не найден введенный номер телефона и т.д. Локализованное поле message обязательно. Поле data должно содержать название субполя account.
Ошибки метода PerformTransaction

Код	Описание
-31003	Транзакция не найдена.
-31008	Невозможно выполнить данную операцию.
-31050 — -31099	Ошибки неверного ввода данных покупателем account, например: не найден введёный логин, не найден введенный номер телефона и т.д. Локализованное поле message обязательно. Поле data должно содержать название субполя account.
Ошибки метода CancelTransaction

Код	Описание
-31003	Транзакция не найдена.
-31007	Заказ выполнен. Невозможно отменить транзакцию. Товар или услуга предоставлена покупателю в полном объеме.
Ошибки метода CheckTransaction

Код	Описание
-31003	Транзакция не найдена
Предыдущая страница
SetFiscalData
Следующая страница
Типы данных

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Merchant APIТипы данных
Типы данных
ID — Строка, длиной 24 символа представляющая собой уникальный идентификатор объекта в системе Payme Business.

Timestamp — Положительное, целое число состоящее из 13 цифр и определяющее количество миллисекунд, прошедших с полуночи 1 января 1970 года UTC.

{
    "method" : "CreateTransaction",
    "params" : {
        ...
        "time" : 1399114284039, // Sat May 03 2014 15:51:24.039
        ...
    }
}

Amount — Положительное, целое число, больше нуля представляющее сумму в тийинах.

Account — Поле “account” представляет собой JSON объект. Набор полей объекта определяется бизнес – логикой конкретного сервиса мерчанта.

Пример

//для мобильного оператора

{
    "account" : {
        "phone" : "903595731"
    }
}

//для интернет провайдера

{
    "account" : {
        "login" : "shsts2645135"
    }
}

//для интернет магазина

{
    "account" : {
        "user" : "2599",
        "order" : "AC-532"
    }
}

Список получателей (Receiver)

Имя	Тип	Описание
id	ID	Идентификатор кассы.
amount	Amount	Сумма платежа в тийинах.
Транзакции (Transaction)

Имя	Тип	Описание
id	ID	Идентификатор транзакции Payme Business.
time	Timestamp	Время создания транзакции Payme Business.
amount	Amount	Сумма платежа в тийинах.
account	Account	Счет покупателя.
create_time	Timestamp	Время добавления транзакции в биллинге мерчанта.
perform_time	Timestamp	Время проведения транзакции в биллинге мерчанта.
cancel_time	Timestamp	Время отмены транзакции в биллинге мерчанта.
transaction	String	Номер или идентификатор транзакции в биллинге мерчанта. Формат строки определяется мерчантом.
state	State	Состояние транзакции.
reason	Reason	Необязательное поле, причина отмены транзакции.
receivers	Receiver[ ]	Список Получателей. Необязательный параметр. В случае если Владелец приложения является Получателем, данное поле следует опустить или присвоить ему значение NULL.
Состояния транзакции (Transaction State)

Код	Описание
1	Транзакция успешно создана, ожидание подтверждения (начальное состояние 0).
2	Транзакция успешно завершена (начальное состояние 1).
-1	Транзакция отменена (начальное состояние 1).
-2	Транзакция отменена после завершения (начальное состояние 2).
Граф состояний транзакции



Причина отмены транзакции (Reason)

Код	Описание
1	Один или несколько получателей не найдены или неактивны в Payme Business.
2	Ошибка при выполнении дебетовой операции в процессинговом центре.
3	Ошибка выполнения транзакции.
4	Транзакция отменена по таймауту.
5	Возврат денег.
10	Неизвестная ошибка.
Состояния чека

Код	Описание
0	Чек создан. Ожидание подтверждения оплаты.
1	Первая стадия проверок. Создание транзакции в биллинге мерчанта.
2	Списание денег с карты.
3	Закрытие транзакции в биллинге мерчанта.
4	Чек оплачен.
5	Чек захолдирован.
6	Получение команды на ходирование чека, после уходит в статус 5. Если чек застрял в этом статусе надолго - необходимо обратиться к техническим специалистам Payme Business.
20	Чек стоит на паузе для ручного вмешательства.
21	Чек в очереди на отмену.
30	Чек в очереди на закрытие транзакции в биллинге мерчанта.
50	Чек отменен.
Предыдущая страница
Ошибки (ERRORS)
Следующая страница
Протокол Subscribe API

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Протокол Subscribe API
Протокол Subscribe API
к сведению
Мерчант обязуется добавить в приложение лейбл "Powered by Payme". В случае выявления нарушения пользования API, Payme имеет право отключить сервис.

Subscribe API позволяет работать с пластиковыми картами и чеком. Payme Business и биллинг мерчанта взаимодействуют по протоколу Subscribe API с помощью запросов и ответов по протоколу удалённого вызова процедур JSON-RPC 2.0.

Чем Subscribe API отличается от Merchant API

В протоколе Subscribe API запросы отправляет приложение мерчанта, а ответы и информацию об ошибках отправляет Payme Business.

Endpoint URL

Payme Business принимает запросы от приложения мерчанта по адресам:

На тестовой платформе: https://checkout.test.paycom.uz/api

В продакшене: https://checkout.paycom.uz/api

Авторизация

Для авторизации в Payme Business приложение отправляет заголовок X-Auth.

Формат заголовка

Для Front-End	Для Back-End
X-Auth: {id}	X-Auth: {id}:{password}
В заголовке: id - это id кассы, Password – ключ-пароль от кассы.

Требования к форме ввода данных пластиковой карты

Элементы ввода в форме не должны содержать атрибут name

Тег form не должен содержать атрибут action.

Требования к содержанию формы ввода данных пластиковой карты

Форма должна содержать:

логотип Payme;

ссылку на оферту Payme;

подсказку или текст о том, что все данные пользователей не передаются мерчанту и хранятся на сервере Payme Business.

Пример формы ввода данных пластиковой карты



Требования к безопасности

Данные пластиковой карты покупателя передаются и сохраняются на сервере мерчанта в зашифрованном виде — токене. Обработка токенов производится с помощью API.

к сведению
Хранить незашифрованные данные пластиковой карты покупателя на сервере мерчанта категорически запрещается!

Тестирование

Чтобы начать тестирование Subscribe API:

Войдите в тестовый кабинет мерчанта.
Логин для входа в кабинет: номер вашего сотового телефона

Пароль для входа в кабинет: qwerty

SMS-код: 666666

В тестовом кабинете создайте бизнес.

Добавьте в бизнес кассу «Виртуальный терминал».

Ключ-пароль от кассы запросите у технического специалиста Payme Business.

к сведению
id кассы для тестов — в адресной строке браузера.



Тестовые карты

Номер	Срок действия карты (Expired)	Комментарий
8600 0609 2109 0842	03/99	SMS-информирование не подключено.
3333 3364 1580 4657	03/99	Срок действия карты истек.
4444 4459 8745 9073	03/99	Карта заблокирована.
8600 1434 1777 0323	03/99	Неизвестная системная ошибка.
8600 1343 0184 9596	03/99	Симуляция задержки обработки на 10 секунд. Заканчивается ошибкой.
8600 4954 7331 6478	03/99	
8600 0691 9540 6311	03/99	
к сведению
SMS-код безопасности для всех тестовых карт всегда: 666666

Рекомендации:

При сохранении токена карты следует предлагать установить ПИН-код для оплаты.

Перед оплатой по сохраненному токену следует запрашивать установленный ПИН код для оплаты;

Если ПИН код для оплаты введен неверно 3 раза, сохранённый токен следует удалить.

Предыдущая страница
Типы данных
Следующая страница
Методы Subscribe API

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe API
Методы Subscribe API
к сведению
Методы Subscribe API — независимы и работают по отдельности.

Для работы с пластиковыми картами в Subscribe API используется 2 вида методов.

Методы для клиентской части приложения мерчанта:

cards.create. Создание токена пластиковой карты.

cards.get_verify_code. Запрос кода для верификации карты.

cards.verify. Верификация карты с помощью кода отправленного по СМС.

Методы для серверной части приложения мерчанта:

cards.check. Проверка токена карты.

cards.remove. Удаление токена карты.

Для работы с чеком, в Subscribe API используются методы для серверной части приложения мерчанта:

receipts.create. Создание чека на оплату.
receipts.pay. Оплата чека.
receipts.send. Отправка инвойса.
receipts.cancel. Установка оплаченного чека в очередь на отмену.
receipts.check. Проверка статуса чека.
receipts.get. Полная информация по чеку.
receipts.get_all. Полная информация по чекам за определенный период.
Предыдущая страница
Протокол Subscribe API
Следующая страница
cards.create

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIcards.create
cards.create
Параметры запроса

Имя	Тип	Описание
id	Integer	Идентификатор запроса.
card	Object	Параметры карты.
number	String	Номер карты.
expire	String	Срок окончания действия карты.
account	Object	Объект Account. Параметр не обязательный.
save	Boolean	Вид токена. Необязательный параметр. Параметр включается или отключается в зависимости от бизнес-логики приложения . Если флаг true токен можно использовать для дальнейших платежей; если флаг false токеном можно использовать только один раз. Одноразовый токен после оплаты удаляется.
customer	String	Любой идентификатор пользователя (номер телефона, uid, email)
Формат запроса

{
    card: {
        number String,
        expire: String
    },
    account: Object,
    save: Boolean
}

Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc
Cache-Control: no-cache

{
    "id": 123,
    "method": "cards.create",
    "params": {
        "card": { "number": "8600069195406311", "expire": "0399"},
        "save": true
    }
}

Параметры ответа

Имя	Тип	Описание
id	Integer	Идентификатор ответа — соответствует идентификатору запроса.
number	String	Неполный номер карты. Строка может храниться на сервере мерчанта.
expire	String	Срок окончания действия карты.
token	String	Токен карты.
recurrent	Boolean	Флаг. Флаг определяет доступность карты для последующих платежей.
verify	Boolean	Флаг. Если флаг true карта проверена способом OTP (one time password).
Формат ответа

{
    card: {
        number: String,
        expire: String,
        token: String,
        recurrent: Boolean,
        verify: Boolean
    }
}

Пример ответа:

{
    "jsonrpc": "2.0",
    "id": 123,
    "result": {
        "card": {
            "number": "860006******6311",
            "expire": "03/99",
            "token": "NTg0YTg0ZDYyYWJiNWNhYTMxMDc5OTE0X1VnYU02ME92IUttWHVHRThJODRJNWE0Xl9EYUBPQCZjNSlPRlpLIWNWRz1PNFp6VkIpZU0kQjJkayoyVUVtUuKElmt4JTJYWj9VQGNAQyVqT1pOQ3VXZ2NyajBEMSYkYj0kVj9NXikrJE5HNiN3K25pKHRQOEVwOGpOcUYxQ2dtemk9dDUwKDNATjd2XythbibihJYoJispJUtuREhlaClraGlJWTlLMihrLStlRjd6MFI3VCgjVDlpYjQ1ZThaMiojPVNTZylYJlFWSjlEZGFuSjZDNDJLdlhXP3YmV1B2dkRDa3g5X2l4N28oU0pOVEpSeXZKYnkjK0h3ViZfdmlhUHMp",
            "recurrent": true,
            "verify": false
        }
    }
}


Предыдущая страница
Методы Subscribe API
Следующая страница
cards.get_verify_code

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIcards.get_verify_code
cards.get_verify_code
Параметры запроса

Имя	Тип	Описание
id	Integer	Идентификатор запроса.
token	String	Токен карты.
Формат запроса

{
    token: String
}

Пример запроса:

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc
Cache-Control: no-cache

{
    "id": 123,
    "method": "cards.get_verify_code",
    "params": {
        "token": "NTg0YTg0ZDYyYWJiNWNhYTMxMDc5OTE0X1VnYU02ME92IUttWHVHRThJODRJNWE0Xl9EYUBPQCZjNSlPRlpLIWNWRz1PNFp6VkIpZU0kQjJkayoyVUVtUuKElmt4JTJYWj9VQGNAQyVqT1pOQ3VXZ2NyajBEMSYkYj0kVj9NXikrJE5HNiN3K25pKHRQOEVwOGpOcUYxQ2dtemk9dDUwKDNATjd2XythbibihJYoJispJUtuREhlaClraGlJWTlLMihrLStlRjd6MFI3VCgjVDlpYjQ1ZThaMiojPVNTZylYJlFWSjlEZGFuSjZDNDJLdlhXP3YmV1B2dkRDa3g5X2l4N28oU0pOVEpSeXZKYnkjK0h3ViZfdmlhUHMp"
    }
}


Параметры ответа

Имя	Тип	Описание
id	Integer	Идентификатор ответа — соответствует идентификатору запроса.
sent	Boolean	Флаг результата отправки.
phone	String	Неполный номер телефона, на который было отправлено смс с кодом.
wait	Number	Период времени, в течении которого OTP (One Time Password) валиден для авторизации.
Формат ответа:

{
    sent: true,
    phone: String,
    wait: Number
}

Пример ответа:

{
    "jsonrpc": "2.0",
    "id": 123,
    "result": {
        "sent": true,
        "phone": "99890*****31",
        "wait": 60000
    }
}

Предыдущая страница
cards.create
Следующая страница
cards.verify

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIcards.verify
cards.verify
Параметры запроса

Имя	Тип	Описание
id	Integer	Идентификатор запроса.
token	String	Токен карты.
code	String	Код для верификации.
Формат запроса:

{
    token: String,
    code: String
}

Пример запроса:

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc
Cache-Control: no-cache

{
    "id": 123,
    "method": "cards.verify",
    "params": {
        "token": "NTg0YTg0ZDYyYWJiNWNhYTMxMDc5OTE0X1VnYU02ME92IUttWHVHRThJODRJNWE0Xl9EYUBPQCZjNSlPRlpLIWNWRz1PNFp6VkIpZU0kQjJkayoyVUVtUuKElmt4JTJYWj9VQGNAQyVqT1pOQ3VXZ2NyajBEMSYkYj0kVj9NXikrJE5HNiN3K25pKHRQOEVwOGpOcUYxQ2dtemk9dDUwKDNATjd2XythbibihJYoJispJUtuREhlaClraGlJWTlLMihrLStlRjd6MFI3VCgjVDlpYjQ1ZThaMiojPVNTZylYJlFWSjlEZGFuSjZDNDJLdlhXP3YmV1B2dkRDa3g5X2l4N28oU0pOVEpSeXZKYnkjK0h3ViZfdmlhUHMp",
        "code": "666666"
    }
}


Пример ответа:

{
  "jsonrpc": "2.0",
  "id": 123,
  "result": {
    "card": {
      "number": "860006******6311",
      "expire": "03/99",
      "token": "NTg0YTgxZWYyYWJiNWNhYTMxMDc5OTExXyVwOTY4TzI3MTJRQ28lWmsoREEyRClYOCtxZ18kVWRLRm0xP3FucVUzJChZazhFV3I1dmtrQiZUaFU5MzZRdSlGbUJPSEh2K1IoWU0lYSg3ZEYlK1QhTUV4P3pUU+KElkMkXjNuIUR6U19pdjY4b3Ffbkt3ajImZTRhZll0dUptNjBVMUF4KXJKJD0qTlNeQmJ5X2Q3bXZNRnZ2UXhfU25TS0dpcGc9V1doUEZxKSM5R0dJYjA9U2dGX2ReZ3lATeKElj9mZWZJS3MzKVp5MjFeOVY5cE8jZWh6cHZLeWZXKSF2PVBfVVU4ei1Gbj82JkI3YjhuRCFWa1omaDB4JEliQm8h",
      "recurrent": true,
      "verify": true
    }
  }
}


Предыдущая страница
cards.get_verify_code
Следующая страница
cards.check

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIcards.check
cards.check
Параметры запроса

Имя	Тип	Описание
id	Integer	Идентификатор запроса.
token	String	Токен карты.
Формат запроса:

{
    token: String
}

Пример запроса:

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc
Content-Type: application/json
Cache-Control: no-cache

{
    "id": 123,
    "method": "cards.check",
    "params": {
        "token": "NTg1Yjc4OWMyYWJiNWNhYTMxMDc5YTE0X3hCJjc/M0NPejR4Jks5JmIxK2QkNCFHJXUqRyplIUB4MHpKVnUxOXZuRHVXK3h3XmVudS1hJFhON01ISSZBUV4jciQ4UD1YdFM4R0F0SmIkK3dfRlXihJYmI2F1MSpYNGNUVFViZkRtekZDNnU3XyElcERtdjRKXmtibWdFYjVpIVF0VW9NZWgzbyN5ZWhGRTdOQkBGU0JhS2ooR1dHZV5pWlJWZCVOekR2VHlJSmh5aSNxdVVXXnp2QUQmanVwb0AxbU1XcEMrcStPRUZQR1ZUTVllVTBeSGNEZkc/OD09JWleVEtqYUE4Y08rJloqVURLcG1rdiZEWCNJUk09dC1KKQ=="
    }
}


Параметры ответа

Имя	Тип	Описание
id	Integer	Идентификатор ответа — соответствует идентификатору запроса.
number	String	Неполный номер карты. Строка может храниться на сервере мерчанта.
expire	String	Срок окончания действия карты.
token	String	Токен карты.
recurrent	Boolean	Флаг, определяющий доступ для последующих платежей с карты.
verify	Boolean	Флаг. Если флаг true карта проверена способом OTP (one time password)
Формат ответа

{
    card: {
        number: String,
        expire: String,
        token: String,
        recurrent: Boolean,
        verify: Boolean
    }
}

Пример ответа:

{
    "jsonrpc": "2.0",
    "id": 123,
    "result": {
        "card": {
          "number": "860006******6311",
          "expire": "03/99",
            "token": "NTg1Yjc4OWMyYWJiNWNhYTMxMDc5YTE0X3hCJjc/M0NPejR4Jks5JmIxK2QkNCFHJXUqRyplIUB4MHpKVnUxOXZuRHVXK3h3XmVudS1hJFhON01ISSZBUV4jciQ4UD1YdFM4R0F0SmIkK3dfRlXihJYmI2F1MSpYNGNUVFViZkRtekZDNnU3XyElcERtdjRKXmtibWdFYjVpIVF0VW9NZWgzbyN5ZWhGRTdOQkBGU0JhS2ooR1dHZV5pWlJWZCVOekR2VHlJSmh5aSNxdVVXXnp2QUQmanVwb0AxbU1XcEMrcStPRUZQR1ZUTVllVTBeSGNEZkc/OD09JWleVEtqYUE4Y08rJloqVURLcG1rdiZEWCNJUk09dC1KKQ==",
            "recurrent": true,
            "verify": true
        }
    }
}


Предыдущая страница
cards.verify
Следующая страница
cards.remove

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIcards.remove
cards.remove
Параметры запроса

Параметр	Тип	Описание
id	Integer	Идентификатор запроса.
token	String	Токен карты.
Формат запроса:

{
    token: String
}

Пример запроса:

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:Rw712wMJspZBczFvrG09?bHkSNxnD4PY0n1C
Content-Type: application/json
Cache-Control: no-cache

{
    "id": 123,
    "method": "cards.remove",
    "params": {
        "token": "NTg1Yjc4OWMyYWJiNWNhYTMxMDc5YTE0X3hCJjc/M0NPejR4Jks5JmIxK2QkNCFHJXUqRyplIUB4MHpKVnUxOXZuRHVXK3h3XmVudS1hJFhON01ISSZBUV4jciQ4UD1YdFM4R0F0SmIkK3dfRlXihJYmI2F1MSpYNGNUVFViZkRtekZDNnU3XyElcERtdjRKXmtibWdFYjVpIVF0VW9NZWgzbyN5ZWhGRTdOQkBGU0JhS2ooR1dHZV5pWlJWZCVOekR2VHlJSmh5aSNxdVVXXnp2QUQmanVwb0AxbU1XcEMrcStPRUZQR1ZUTVllVTBeSGNEZkc/OD09JWleVEtqYUE4Y08rJloqVURLcG1rdiZEWCNJUk09dC1KKQ=="
    }
}


Формат ответа:

{
    success: Boolean
}

Пример ответа:

{
    "jsonrpc": "2.0",
    "id": 123,
    "result": {
        "success": true
    }
}

Предыдущая страница
cards.check
Следующая страница
receipts.create

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIreceipts.create
receipts.create
Параметры запроса

Имя	Тип	Описание
id	Integer	Идентификатор запроса
amount	Number	Сумма платежа в тийинах
account	Object	Объект Account
description	String	Описание платежа, необязательный параметр
detail	Object	Объект детализации платежа, необязательный параметр
Формат запроса

{
    amount: Number,
    account: Object,
    description: String,
    detail: Object //ниже приведён пример объекта детализаци
}


Пример объекта детализации

{
    "receipt_type": 0, //тип фискального чека
    "shipping" : { //доставка, необязательное поле
          "title" : "Доставка до ттз-4 28/23", "price" : 500000
    },
    "items" : [ //товарная позиция, необязательное поле 
            { 
                    "discount":10000, //Скидка с учетом количества товаров или услуг в тийинах
                    "title": "Помидоры", //нааименование товара или услуги
                    "price": 505000, //цена за единицу товара или услуги, сумма указана в тийинах
                    "count": 2, //кол-во товаров или услуг
                    "code": "00702001001000001", // код *ИКПУ обязательное поле
                    "units": 241092, //значение изменится в зависимости от вида товара
                    "vat_percent": 15, //обязательное поле, процент уплачиваемого НДС для данного товара или услуги
                    "package_code": "123456" //Код упаковки для конкретного товара или услуги, содержится на сайте в деталях найденного ИКПУ
            }
    ]
}


*ИКПУ - это идентификационный код продукции и услуг.

Имя	Тип	Описание	Обязательное поле
receipt_type	Number	Продажа/Возврат = 0	да
shipping	Object	Доставка	нет
items	Array	Товарная позиция	да
Параметры массива items

Имя	Тип	Описание	Обязательное поле
discount	Number	Скидка с учетом количества товаров или услуг в тийинах	нет
title	String	Название продукта	да
price	Number	Цена за единицу товара или услугу в тийинах	да
count	Number	Количество товаров или услуг	да
code	String	ИКПУ (идентификационный код продукции и услуг)	да
units	Number	Код единицы измерения	нет
package_code	String	Код упаковки продукта	да
vat_percent	Number	Процент уплачиваемого НДС для данного товара	да
Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:Rw712wMJspZBczFvrG09?bHkSNxnD4PY0n1C
Content-Type: application/json
Cache-Control: no-cache

{
    "id": 4,
    "method": "receipts.create",
    "params": {
        "amount": 500000,
        "account": {
            "order_id": "test"
        },
        "detail": {
            "receipt_type": 0,
            "shipping": {
                "title": "Доставка до ттз-4 28/23",
                "price": 500000
            },
            "items": [
                {
                    "discount":10000, //Скидка с учетом количества товаров или услуг в тийинах
                    "title": "Помидоры",
                    "price": 505000,
                    "count": 2,
                    "code": "00702001001000001",
                    "units": 241092,
                    "vat_percent": 15,
                    "package_code": "123456"
                }
            ]
        }
    }
}


Формат ответа

{
    result: receipt
}

Пример ответа

{
    "jsonrpc": "2.0",
    "id": 4,
    "result": {
        "receipt": {
            "_id": "62da73b0803aced907a52b46",
            "create_time": 1658483632482,
            "pay_time": 0,
            "cancel_time": 0,
            "state": 0,
            "type": 2,
            "external": false,
            "operation": -1,
            "category": null,
            "error": null,
            "description": "",
            "detail": {
                "discount": {
                    "title": "Скидка 5%",
                    "price": 10000
                },
                "shipping": {
                    "title": "Доставка до ттз-4 28/23",
                    "price": 500000
                },
                "items": [
                    {
                        "title": "Помидоры",
                        "price": 505000,
                        "count": 2,
                        "code": "00702001001000001",
                        "units": 241092,
                        "vat_percent": 15,
                        "package_code": "123456"
                    }
                ]
            },
            "amount": 500000,
            "currency": 860,
            "commission": 0,
            "account": [
                {
                    "name": "order_id",
                    "title": "Номер заказа",
                    "value": "test",
                    "main": true
                },
                {
                    "name": "transaction",
                    "title": "Номер чека",
                    "value": "80",
                    "main": false
                }
            ],
            "card": null,
            "merchant": {
                "_id": "62d52ce6ca96effd0777a771",
                "name": "test",
                "organization": "ЧП «test test»",
                "address": "",
                "business_id": "62d52c4bca96effd0777a770",
                "epos": {
                    "merchantId": "106600000050000",
                    "terminalId": "20660000"
                },
                "date": 1658137830827,
                "logo": null,
                "type": "Интернет",
                "terms": null
            },
            "meta": {
                "source": "subscribe",
                "owner": "62d52ce6ca96effd0777a771"
            },
            "processing_id": null
        }
    }
}

Предыдущая страница
cards.remove
Следующая страница
receipts.pay

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIreceipts.pay
receipts.pay
Параметры запроса

Имя	Тип	Описание
id	String	ID Чека.
token	String	Токен карты.
payer	Object	Объект “payer” — необязательный. Содержит дополнительную информацию о плательщике. Используется для системы антифрода.
Формат запроса

id: String,
token: String,
payer: {
    id: String,
    phone: String,
    email: String,
    name: String,
    ip: String
}

Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:Rw712wMJspZBczFvrG09?bHkSNxnD4PY0n1C
Content-Type: application/json
Cache-Control: no-cache

{
    "id": 123,
    "method": "receipts.pay",
    "params": {
        "id": "2e0b1bc1f1eb50d487ba268d",
        "token": "NTg1Yjc4OWMyYWJiNWNhYTMxMDc5YTE0X3hCJjc/M0NPejR4Jks5JmIxK2QkNCFHJXUqRyplIUB4MHpKVnUxOXZuRHVXK3h3XmVudS1hJFhON01ISSZBUV4jciQ4UD1YdFM4R0F0SmIkK3dfRlXihJYmI2F1MSpYNGNUVFViZkRtekZDNnU3XyElcERtdjRKXmtibWdFYjVpIVF0VW9NZWgzbyN5ZWhGRTdOQkBGU0JhS2ooR1dHZV5pWlJWZCVOekR2VHlJSmh5aSNxdVVXXnp2QUQmanVwb0AxbU1XcEMrcStPRUZQR1ZUTVllVTBeSGNEZkc/OD09JWleVEtqYUE4Y08rJloqVURLcG1rdiZEWCNJUk09dC1KKQ==",
        "payer": {
            "phone": "998901304527"
        }
    }
}


Формат ответа

{
    result: receipt
}

Пример ответа

{
  "jsonrpc": "2.0",
  "id": null,
  "result": {
    "receipt": {
      "_id": "2e0b1bc1f1eb50d487ba268d",
      "create_time": 1481113810044,
      "pay_time": 1481113810265,
      "cancel_time": 0,
      "state": 4,
      "type": 1,
      "external": false,
      "operation": -1,
      "category": null,
      "error": null,
      "description": "",
      "detail": null,
      "amount": 3500,
      "commission": 0,
      "account": [
        {
          "name": "order_id",
          "title": "Код заказа",
          "value": "5"
        }
      ],
      "card": {
        "number": "860006******6311",
        "expire": "0399"
      },
      "merchant": {
        "_id": "100fe486b33784292111b7dc",
        "name": "Online Shop LLC",
        "organization": "ЧП «Online Shop»",
        "address": "",
        "epos": {
          "merchantId": "106600000050000",
          "terminalId": "20660000"
        },
        "date": 1480582278779,
        "logo": null,
        "type": "Shop",
        "terms": null,
        "payer": {
                    "phone": "998912345678"
         }
      },
      "meta": null
    }
  }
}

Предыдущая страница
receipts.create
Следующая страница
receipts.send

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIreceipts.send
receipts.send
Метод используется для отправки чека на оплату в SMS-сообщении.

Параметры запроса

Параметр	Тип	Описание
id	String	ID Чека
phone	String	Номер телефона получателя инвойса
Формат запроса

{
    id: String,
    phone: string
}

Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:Rw712wMJspZBczFvrG09?bHkSNxnD4PY0n1C
Content-Type: application/json
Cache-Control: no-cache

{
    "id": 123,
    "method": "receipts.send",
    "params": {
        "id": "2e0b1bc1f1eb50d487ba268d",
        "phone": "998901304527"
    }
}

Формат ответа

{ 
  "result": {
    "success":  boolean
  }
}

Пример ответа

{
  "jsonrpc": "2.0",
  "result": {
    "success": true
  }
}

Предыдущая страница
receipts.pay
Следующая страница
receipts.cancel

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIreceipts.cancel
receipts.cancel
Параметры запроса

Параметр	Тип	Описание
id	String	ID Чека
Формат запроса

{
    id: String
}

Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:Rw712wMJspZBczFvrG09?bHkSNxnD4PY0n1C
Content-Type: application/json
Cache-Control: no-cache

{
    "id": 123,
    "method": "receipts.cancel",
    "params": {
        "id": "2e0b1bc1f1eb50d487ba268d"
    }
}

Формат ответа

{
    result: receipt
}

Пример ответа

{
    "jsonrpc": "2.0",
    "id": 123,
    "result": {
        "receipt": {
            "_id": "2e0b1bc1f1eb50d487ba268d",
            "create_time": 1482823890336,
            "pay_time": 1482823890564,
            "cancel_time": 0,
            "state": 21,
            "type": 1,
            "external": false,
            "operation": -1,
            "category": null,
            "error": null,
            "description": "",
            "detail": null,
            "amount": 2000,
            "commission": 0,
            "account": [
                {
                    "name": "order_id",
                    "title": "Код заказа",
                    "value": "124"
                }
            ],
            "card": null,
            "merchant": {
                "_id": "100fe486b33784292111b7dc",
                "name": "Online Shop LLC",
                "organization": "ЧП «Online Shop»",
                "address": "",
                "epos": {
                    "merchantId": "106600000050000",
                    "terminalId": "20660000"
                },
                "date": 1480582278779,
                "logo": null,
                "type": "Shop",
                "terms": null
            },
            "meta": null
        }
    }
}

Предыдущая страница
receipts.send
Следующая страница
receipts.check

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIreceipts.check
receipts.check
Параметры запроса

Параметр	Тип	Описание
id	String	ID Чека
Формат запроса

{
    id: String
}

Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:Rw712wMJspZBczFvrG09?bHkSNxnD4PY0n1C
Content-Type: application/json
Cache-Control: no-cache

{
    "id": 123,
    "method": "receipts.check",
    "params": {
        "id": "2e0b1bc1f1eb50d487ba268d"
    }
}

Параметры ответа

Параметр	Тип	Описание
state	Number	Состояние чека.
Формат ответа

{
    state: Number
}

Пример ответа:

{
    "jsonrpc": "2.0",
    "id": 123,
    "result": {
        "state": 4
    }
}

Предыдущая страница
receipts.cancel
Следующая страница
receipts.get

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIreceipts.get
receipts.get
Параметры запроса

Имя	Тип	Описание
id	String	ID Чека
Формат запроса

{
    id: String
}

Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:Rw712wMJspZBczFvrG09?bHkSNxnD4PY0n1C
Content-Type: application/json
Cache-Control: no-cache

{
    "id": 123,
    "method": "receipts.get",
    "params": {
        "id": "2e0b1bc1f1eb50d487ba268d"
    }
}

Пример ответа

{
    "jsonrpc": "2.0",
    "id": 123,
    "result": {
        "receipt": {
            "_id": "2e0b1bc1f1eb50d487ba268d",
            "create_time": 1482823890336,
            "pay_time": 1482823890564,
            "cancel_time": 0,
            "state": 4,
            "type": 1,
            "external": false,
            "operation": -1,
            "category": null,
            "error": null,
            "description": "",
            "detail": null,
            "amount": 2000,
            "commission": 0,
            "account": [
                {
                    "name": "order_id",
                    "title": "Код заказа",
                    "value": "124"
                }
            ],
            "card": null,
            "merchant": {
                "_id": "100fe486b33784292111b7dc",
                "name": "Online Shop LLC",
                "organization": "ЧП «Online Shop»",
                "address": "",
                "epos": {
                    "merchantId": "106600000050000",
                    "terminalId": "20660000"
                },
                "date": 1480582278779,
                "logo": null,
                "type": "Shop",
                "terms": null,
                "payer": {
                    "phone": "998912345678"
                }
            },
            "meta": null
        }
    }
}

Предыдущая страница
receipts.check
Следующая страница
receipts.get_all

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIreceipts.get_all
receipts.get_all
Параметры запроса

Имя	Тип	Описание
id	Integer	Идентификатор запроса.
count	Integer	Количество чеков. Максимальное значение - 50
from	timestamp	Дата начала
to	timestamp	Дата окончания
offset	Integer	Количество последующих пропускаемых чеков. Пропускает от начала даты
Формат запроса

{
    "id": Integer,
    "method": "receipts.get_all",
    "params": {
        "count": Integer
        "from": timestamp,
        "to": timestamp,
        "offset": Integer
    }
}

Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:mjES8ycLucnvygt4dPwerK2vj45Eensn3ZPr
Cache-Control: no-cache

{
    "id": 123,
    "method": "receipts.get_all",
    "params": {
        "count": 2,
        "from": 1636398000000,
        "to": 1636398000000,
        "offset": 0
    }
}

Пример ответа:

{
    "jsonrpc": "2.0",
    "id": 123,
    "result": [
        {
            "_id": "618a5b9f1045eb4efde669a4",
            "create_time": 1636457473995,
            "pay_time": 1636457474283,
            "cancel_time": 0,
            "state": 4,
            "type": 2,
            "external": false,
            "operation": -1,
            "category": null,
            "error": null,
            "description": "",
            "detail": null,
            "amount": 100000,
            "currency": 860,
            "commission": 0,
            "account": [
                {
                    "name": "loan_id",
                    "title": {
                        "ru": "Логин",
                        "uz": "Login",
                        "en": "Login"
                    },
                    "value": "2",
                    "main": true
                },
                {
                    "name": "transaction",
                    "title": {
                        "ru": "Номер чека",
                        "uz": "Chek raqami"
                    },
                    "value": 1544,
                    "main": false
                }
            ],
            "card": {
                "number": "8600069195406311",
                "expire": "9903"
            },
            "merchant": {
                "_id": "5e730e8e0b852a417aa49ceb",
                "name": "test",
                "organization": "ЧП «test test»",
                "address": "",
                "business_id": "5e730e740b852a417aa49cea",
                "epos": {
                    "merchantId": "106600000050000",
                    "terminalId": "20660000"
                },
                "date": 1584598670296,
                "logo": null,
                "type": {
                    "ru": "Internet",
                    "uz": "Internet"
                },
                "terms": null
            },
            "meta": {
                "source": "subscribe",
                "owner": "5e730e8e0b852a417aa49ceb"
            },
            "processing_id": 0
        },
        {
            "_id": "618a5a881045eb4efde669a3",
            "create_time": 1636457352583,
            "pay_time": 1636457352898,
            "cancel_time": 0,
            "state": 4,
            "type": 2,
            "external": false,
            "operation": -1,
            "category": null,
            "error": null,
            "description": "",
            "detail": null,
            "amount": 100000,
            "currency": 860,
            "commission": 0,
            "account": [
                {
                    "name": "loan_id",
                    "title": {
                        "ru": "Логин",
                        "uz": "Login",
                        "en": "Login"
                    },
                    "value": "1",
                    "main": true
                },
                {
                    "name": "transaction",
                    "title": {
                        "ru": "Номер чека",
                        "uz": "Chek raqami"
                    },
                    "value": 1543,
                    "main": false
                }
            ],
            "card": {
                "number": "8600069195406311",
                "expire": "9903"
            },
            "merchant": {
                "_id": "5e730e8e0b852a417aa49ceb",
                "name": "test",
                "organization": "ЧП «test test»",
                "address": "",
                "business_id": "5e730e740b852a417aa49cea",
                "epos": {
                    "merchantId": "106600000050000",
                    "terminalId": "20660000"
                },
                "date": 1584598670296,
                "logo": null,
                "type": {
                    "ru": "Internet",
                    "uz": "Internet"
                },
                "terms": null
            },
            "meta": {
                "source": "subscribe",
                "owner": "5e730e8e0b852a417aa49ceb"
            },
            "processing_id": 0
        }
    ]
}

Предыдущая страница
receipts.get
Следующая страница
receipts.set_fiscal_data

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIreceipts.set_fiscal_data
receipts.set_fiscal_data
Передача фискального чека в Payme

Параметры запроса

Имя	Тип	Описание	Обязательное поле
id	Integer	Идентификатор запроса.	Да
params.id	String	Уникальный id чека в БД Payme	Да
fiscal_data.status_code	Integer	Код статуса, ниже приведен список кодов	Нет
fiscal_data.message	String	Детальная информация об ошибке (если произошла ошибка при регистрации чека в ОФД)	Нет
fiscal_data.terminal_id	String	Номер Виртуального Фискального Модуля	Нет
fiscal_data.receipt_id	Integer	Уникальный порядковый номер платежа для Виртуального Фискального Модуля	Да
fiscal_data.date	String	Дата регистрации чека на стороне ОФД	Нет
fiscal_data.fiscal_sign	String	Фискальный Признак чека платежа	Нет
fiscal_data.qr_code_url	String	URL адрес фискального чека	Да
Формат запроса

{
    "id": Integer,
    "method": "receipts.set_fiscal_data",
    "params": {
        "id": String,
        "fiscal_data": {
            "status_code": Integer,
            "message": String,
            "terminal_id": String,
            "receipt_id": Integer,
            "date": String,
            "fiscal_sign": String,
            "qr_code_url": String,
        }
    }
}

Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:mjES8ycLucnvygt4dPwerK2vj45Eensn3ZPr
Cache-Control: no-cache

{
    "id": 123,
    "method": "receipts.set_fiscal_data",
    "params": {
        "id": "2e0b1bc1f1eb50d487ba268d",
        "fiscal_data": {
            "status_code": 0;          
            "message": "accepted";     
            "terminal_id": "EP000000000025"; 
            "receipt_id": 121;              
            "date": "20220706221021";             
            "fiscal_sign": "800031554082";   
            "qr_code_url": "fiscal receipt url";
        }
    }
}

Пример ответа:

{
    "jsonrpc": "2.0",
    "id": 123,
    "result": {
        "success": true
    }
}

Предыдущая страница
receipts.get_all
Следующая страница
Состояния чека

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIСостояния чека
Состояния чека
Код	Описание
0	Чек создан. Ожидание подтверждения оплаты.
1	Первая стадия проверок. Создание транзакции в биллинге поставщика.
2	Списание денег с карты
3	Закрытие транзакции в биллинге поставщика
4	Чек оплачен
5	Чек заходирован
6	Получение команды на холдирование средств. Если чек находится в этом статусе достаточно долго - необходимо обратиться к техническим специалистам Payme Business
20	Чек стоит на паузе для ручного вмешательства
21	Чек в очереди на отмену
30	Чек в очереди на закрытие транзакции в биллинге поставщика
50	Чек отменен
Предыдущая страница
receipts.set_fiscal_data
Следующая страница
Холдирование

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Методы Subscribe APIХолдирование
Холдирование
Для работы с холдирование вам необходимо реализовать протокол Subscribe API с методами создания токена карты, с которой будут сниматься средства.

Для создания платежа с холдированием необходимо указать дополнительный флаг "hold: true" в методе receipts.create.

Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:Rw712wMJspZBczFvrG09?bHkSNxnD4PY0n1C
Content-Type: application/json
Cache-Control: no-cache

{
    "id": 123,
    "method": "receipts.create",
    "params": {
    "account": {
            "order_id": 106
        },
        "amount": 2500,
        "hold": true,
    }
}

В методе receipts.pay флаг hold: true также необходим

Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:Rw712wMJspZBczFvrG09?bHkSNxnD4PY0n1C
Content-Type: application/json
Cache-Control: no-cache

{
    "id": 1596783866930,
    "method": "receipts.pay",
    "params": {
        "id": "{{ProdReceiptId}}", // id транзакции
        "token": "{{ProdCardToken}}", //токен карты
        "hold": true
    }
}

Пример ответа

{
    "jsonrpc": "2.0",
    "id": 123,
    "result": {
        "receipt": {
            "_id": "624c0c2b0ac8b463e47422c7",
            "create_time": 1649150518480,
            "pay_time": 0,
            "cancel_time": 0,
            "state": 5, //state 5 - средства захолдированы
            "type": 1,
            "external": false,
            "operation": -1,
            "category": null,
            "error": null,
            "description": "",
            "detail": null,
            "amount": 100,
            "currency": 860,
            "commission": 0,
            "account": [
                {
                    "name": "order_id",
                    "title": "order_id",
                    "value": "5905",
                    "main": true
                },
                {
                    "name": "xEntityTaxpayerID",
                    "title": "ИНН юр.лица",
                    "value": "309085172"
                }
            ],
            "sensitive_data": [],
            "card": {
                "number": "626247**********",
                "expire": "2205"
            },
            "merchant": {
                "_id": "623c4fe9bd1c329a32de808e",
                "name": "Наименовагние компании ",
                "organization": "ООО «Наименовагние компании»",
                "address": "",
                "business_id": "61b19ee2204c85a50a879ae1",
                "epos": {
                    "merchantId": "",
                    "terminalId": ""
                },
                "date": 1648119785244,
                "logo": "https://cdn.paycom.uz/merchants/8bca7f164642da3c6287122159986bebb9f98c0e.png",
                "type": "Другие услуги здоровья и фармацевтики",
                "terms": null
            },
            "meta": {
                "source": "subscribe",
                "owner": "623c4fe9bd1c329a32de808e"
            },
            "processing_id": 0
        }
    }
}


Для снятия холдированных средств используется метод receipts.confirm_hold

Пример запроса

POST /api HTTP/1.1
Host: checkout.test.paycom.uz
X-Auth: 100fe486b33784292111b7dc:Rw712wMJspZBczFvrG09?bHkSNxnD4PY0n1C
Content-Type: application/json
Cache-Control: no-cache

{
    "id": 123,
    "method": "receipts.confirm_hold",
    "params": {
        "id": "624c0c2b0ac8b463e47422c7"
    }
}

Пример ответа

{
    "jsonrpc": "2.0",
    "id": 9,
    "result": {
        "receipt": {
            "_id": "624c0c2b0ac8b463e47422c7",
            "create_time": 1649151033299,
            "pay_time": 1649151041276,
            "cancel_time": 0,
            "state": 4, //state 4 - холд подтвержден, чек оплачен
            "type": 1,
            "external": false,
            "operation": -1,
            "category": null,
            "error": null,
            "description": "",
            "detail": null,
            "amount": 100,
            "currency": 860,
            "commission": 0,
            "account": [
                {
                    "name": "order_id",
                    "title": "order_id",
                    "value": "5905",
                    "main": true
                },
                {
                    "name": "xEntityTaxpayerID",
                    "title": "ИНН юр.лица",
                    "value": "*********"
                }
            ],
            "sensitive_data": [],
            "card": {
                "number": "860031**********",
                "expire": "2609"
            },
            "merchant": {
                "_id": "623c4fe9bd1c329a32de808e",
                "name": "Наименовагние компании ",
                "organization": "ООО «Наименовагние компании»",
                "address": "",
                "business_id": "61b19ee2204c85a50a879ae1",
                "epos": {
                    "merchantId": "",
                    "terminalId": ""
                },
                "date": 1648119785244,
                "logo": "https://cdn.paycom.uz/merchants/8bca7f164642da3c6287122159986bebb9f98c0e.png",
                "type": "Другие услуги здоровья и фармацевтики",
                "terms": null
            },
            "meta": {
                "source": "subscribe",
                "owner": "623c4fe9bd1c329a32de808e"
            },
            "processing_id": 0
        }
    }
}


Состояние чека можно узнать тут

Для отмены холдирования используется метод receipts.cancel

Процессинг UZCARD отменяет холдирование по истечению 30 дней с момента холдирования

Процессинг HUMO имеет ограничение подтвреждения/отмены холдирования в течении 30 дней. По истечению 30 дней холдирование можно только подтвердить.

Для работы холдирования средств необходимо предупредить технического специалиста Payme Business. В противном случае холдирование на кассе работать не будет.

Протестировать холдирование средств можно только в боевом режиме.

Предыдущая страница
Состояния чека
Следующая страница
Взаимодействие протоколов Merchant API и Subscribe API

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Взаимодействие протоколов Merchant API и Subscribe API
Взаимодействие протоколов Merchant API и Subscribe API
Порядок взаимодействия протоколов Merchant API и Subscribe API осуществляется в соответствии с процессом, показанным на схеме:



Каждый протокол тестируется отдельно.

Тестирование Merchant API

Протокол Merchant API можно протестировать в Песочнице.

Тестирование Subscribe API

Для тестирования Subscribe API:

Войдите в тестовый кабинет мерчанта.
Логин для входа в кабинет: номер вашего сотового телефона

Пароль для входа в кабинет: qwerty

SMS-код: 666666

В тестовом кабинете создайте бизнес.
Добавьте в бизнес кассу «Виртуальный терминал».
Ключ-пароль от кассы запросите у технического специалиста Payme Business.
Тестовые запросы посылаются на тестовую платформу:
https://checkout.test.paycom.uz/api

Предыдущая страница
Холдирование
Следующая страница
Инициализация платежей

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Инициализация платежей
Инициализация платежей
Инициализация (приём) платежей производится с помощью формы оплаты — чека. Чек формируется на стороне мерчанта. Отправка чека производится с помощью методов: POST и GET.

Отправка чека по методу POST

Отправка чека по методу GET

Ошибки отправки чека

Генерация кнопки оплаты и QR-кода

Предыдущая страница
Взаимодействие протоколов Merchant API и Subscribe API
Следующая страница
Генерация кнопки оплаты и QR-кода

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Инициализация платежейГенерация кнопки оплаты и QR-кода
Генерация кнопки оплаты и QR-кода
Чтобы сгенерировать кнопку оплаты и/или QR-код, к странице следует подключить скрипт https://cdn.paycom.uz/integration/js/checkout.min.js

Пример кода для генерации кнопки оплаты

<body onload="Paycom.Button('#form-payme', '#button-container')">
<form id="form-payme" method="POST" action="https://checkout.paycom.uz/">
    <input type="hidden" name="merchant" value="587f72c72cac0d162c722ae2">
    <input type="hidden" name="account[order_id]" value="197">
    <input type="hidden" name="amount" value="500">
    <input type="hidden" name="lang" value="ru">
    <input type="hidden" name="button" data-type="svg" value="colored">
    <div id="button-container"></div>
</form>
<!-- ... -->
<script src="https://cdn.paycom.uz/integration/js/checkout.min.js"></script>
</body>

Результат



Пример кода для генерации QR-кода

<body onload="Paycom.QR('#form-payme', '#qr-container')">
<form id="form-payme" method="POST" action="https://checkout.paycom.uz/">
    <input type="hidden" name="merchant" value="587f72c72cac0d162c722ae2">
    <input type="hidden" name="account[order_id]" value="197">
    <input type="hidden" name="amount" value="500">
    <input type="hidden" name="lang" value="ru">
    <input type="hidden" name="qr" data-width="250">
    <div id="qr-container"></div>
</form>
<!-- ... -->
<script src="https://cdn.paycom.uz/integration/js/checkout.min.js"></script>
</body>

Результат



После нажатия кнопки или после сканирования QR-кода покупатель окажется на странице оплаты



Доступные методы

Paycom.Button(form_selector, button_container_selector);
Paycom.QR(form_selector, qr_container_selector);

Аргументы

Параметр	Описание
form_selector	Селектор для формы, jQuery объект или HTML DOM объект.
button_container_selector	Селектор контейнера кнопки, jQuery объект или HTML DOM объект.
qr_container_selector	Селектор контейнера QR-кода, jQuery объект или HTML DOM объект.
Параметры чека и кнопки в форме

Параметр	Описание
merchant	ID или алиас мерчанта.
account	Объект Account.
amount	Сумма платежа.
lang	Язык пользователя. Доступные значения: ru, uz, en.
callback	URL адрес возврата после оплаты или отмены платежа.
callback_timeout	Время ожидания после успешного платежа в миллисекундах, до возврата покупателя на сайт мерчанта.
description	Описание платежа.
detail	Детальное описание платежа.
button	Параметры кнопки (data-type = svg, png - формат, value = colored, white - стиль, data-width = 200px - ширина).
Стили кнопки

Язык	value=”colored”	value=”white”
lang=”ru”		
lang=”uz”		
Предыдущая страница
Инициализация платежей
Следующая страница
Отправка чека по методу POST

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Инициализация платежейОтправка чека по методу POST
Отправка чека по методу POST
Пример чека

<form method="POST" action="https://test.paycom.uz">

    <!-- Идентификатор WEB Кассы -->
    <input type="hidden" name="merchant" value="{Merchant ID}"/>

    <!-- Сумма платежа в тийинах -->
    <input type="hidden" name="amount" value="{сумма чека в ТИИНАХ}"/>

    <!-- Поля Объекта Account -->
    <input type="hidden" name="account[{field_name}]" value="{field_value}"/>

    <!-- ==================== НЕОБЯЗАТЕЛЬНЫЕ ПОЛЯ ====================== -->
    <!-- Язык. Доступные значения: ru|uz|en 
         Другие значения игнорируются
         Значение по умолчанию ru -->
    <input type="hidden" name="lang" value="ru"/>

    <!-- URL возврата после оплаты или отмены платежа.
         Если URL возврата не указан, он берется из заголовка запроса Referer.
         URL возврата может содержать параметры, которые заменяются Paycom при запросе.
         Доступные параметры для callback:
         :transaction - id транзакции или "null" если транзакцию не удалось создать
         :account.{field} - поля объекта Account
         Пример: https://your-service.uz/paycom/:transaction -->
    <input type="hidden" name="callback" value="{url возврата после платежа}"/>

    <!-- Таймаут после успешного платежа в миллисекундах. 
         Значение по умолчанию 15
         После успешной оплаты, по истечении времени callback_timeout
         производится перенаправление пользователя по url возврата после платежа -->
    <input type="hidden" name="callback_timeout" value="{miliseconds}"/>

    <!-- Описание платежа
         Для описания платежа доступны 3 языка: узбекский, русский, английский. 
         Для описания платежа на нескольких языках следует использовать 
         несколько полей с атрибутом  name="description[{lang}]"
         lang может принимать значения ru|en|uz -->
    <input type="hidden" name="description" value="{Описание платежа}"/>

    <!-- Объект детализации платежа
         Поле для детального описания платежа, например, перечисления 
         купленных товаров, стоимости доставки, скидки. 
         Значение поля (value) — JSON-строка закодированная в BASE64 -->
    <input type="hidden" name="detail" value="{JSON объект детализации в BASE64}"/>
    <!-- ================================================================== -->

    <button type="submit">Оплатить с помощью <b>Payme</b></button>
</form>


Объект детализации

Поле детального описания платежа.

В детальном описании платежа:

перечисляются товарные позиции;

указывается стоимость доставки;

указывается размер скидки.

Значение поля (value) — JSON-строка закодированная в BASE64.

Пример объекта детализации

"detail": {
            "receipt_type": 0, //тип фискального чека
            "shipping": { //доставка, необязательное поле
                "title": "Доставка до ттз-4 28/23",
                "price": 500000
            },
            "items": [ //товарная позиция, обязательное поле дл фискализации
                {
                    "discount":10000, //Скидка с учетом количества товаров или услуг в тийинах
                    "title": "Помидоры", //нааименование товара или услуги
                    "price": 505000, //цена за единицу товара или услуги, сумма указана в тийинах
                    "count": 2, //кол-во товаров или услуг
                    "code": "00702001001000001", // код *ИКПУ обязательное поле
                    "units": 241092, //значение изменится в зависимости от вида товара
                    "vat_percent": 15, //обязательное поле, процент уплачиваемого НДС для данного товара или услуги
                    "package_code": "123456" //Код упаковки для конкретного товара или услуги, содержится на сайте в деталях найденного ИКПУ.
                }
            ]
        }


*ИКПУ - это идентификационный код продукции и услуг.

Типы данных

Имя	Тип	Описание
receipt_type	Number	Продажа/Возврат = 0
shipping	Объект	Доставка, необязательное поле.
items	Массив объектов	Товарная позиция, необязательное поле.
Параметры массива items

Имя	Тип	Описание	Обязательное поле
discount	Number	Скидка с учетом количество товаров или услуг в тийинах	нет
title	String	Название продукта	да
price	Number	Цена за единицу товара или услугу в тийинах	да
count	Number	Количество товаров или услуг	да
code	String	ИКПУ (идентификационный код продукции и услуг)	да
units	Number	Код единицы измерения	нет
package_code	String	Код упаковки продукта	да
vat_percent	Number	Процент уплачиваемого НДС для данного товара	да
Предыдущая страница
Генерация кнопки оплаты и QR-кода
Следующая страница
Отправка чека по методу GET

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Инициализация платежейОтправка чека по методу GET
Отправка чека по методу GET
Методом GET чек отправляется в виде URL:

Формат URL - <checkout_url>/base64(params)

Разделитель параметров - ;

Формат параметров - key=value

Параметры

Параметр	Описание
m	ID или алиас мерчанта.
ac	Объект Account.
a	Сумма платежа (указывается в тийинах).
l	Язык. Доступные значения: ru, uz, en.
c	URL адрес возврата после оплаты или отмены платежа.
ct	Время ожидания после успешного платежа в миллисекундах, до возврата покупателя на сайт мерчанта.
cr	Код валюты в ISO формате
Пример формирования URL

Данные:

m=587f72c72cac0d162c722ae2 — ID мерчанта

ac.order_id=197 — Код заказа ( order_id — параметр объекта Account в настройках веб кассы)

a=500 — Сумма платежа 5 сум (в тийинах)

Пример сформированного URL: https://checkout.paycom.uz/base64(m=587f72c72cac0d162c722ae2;ac.order_id=197;a=500)

Результат:

https://checkout.paycom.uz/bT01ODdmNzJjNzJjYWMwZDE2MmM3MjJhZTI7YWMub3JkZXJfaWQ9MTk3O2E9NTAw


Пример формы по сформированному URL:



Предыдущая страница
Отправка чека по методу POST
Следующая страница
Ошибки отправки чека

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Инициализация платежейОшибки отправки чека
Ошибки отправки чека
Код	Описание
-31601	Мерчант не найден или заблокирован.
-31610	Введено неверное значение поля.
-31611	Сумма платежа меньше допустимой.
-31612	Сумма платежа больше допустимой.
-31622	Сервис мерчанта недоступен.
-31623	Сервис мерчанта работает некорректно.
-31630	Ошибка возникает в случаях: недостаточно средств на карте, введён неверный номер карты, введена неверная дата окончания срока действия карты, карта устарела или заблокирована, платёж производится с корпоративной карты.
Предыдущая страница
Отправка чека по методу GET
Следующая страница
Пример реализации сервера

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Пример реализации сервера
Пример реализации сервера
Пример реализации сервера на PHP.

Пример реализации сервера на Java (Kotlin).

Предыдущая страница
Ошибки отправки чека
Следующая страница
Плагины для CMS

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Плагины для CMS
Плагины для CMS
WooCommerce. Требования: PHP 5.4 и выше; WordPress 4.x и выше; WooCommerce 3.x и выше.

OperCart 2.x. Требования: PHP 5.3 и выше; Web Server (Apache suggested); Database (MySQLi suggested).

OpenCart 3.x. Требования: OpenCart 3.x.

Magento. Требования: PHP 7.1 для Magento v 2.2; PHP 7.0 для Magento v 2.1.11.

Joomshopping. Требования: Joomla 3.x и выше; JoomShopping 4.15 и выше.

VirtueMart. Требования: Joomla 3.7.0 и выше; Virtuemart 3.0.10 и выше.

1C-Bitriks. Требования: PHP 5.3 и выше; 1С-Битрикс ( Малый бизнес, Бизнес и Бизнес Веб-кластер) 18.5.150 и выше; Web Server (Apache suggested); Database (MySQLi suggested).

Webasyst Shop-Script. Требования: PHP 5.3 и выше; Webasyst 1.10.7 и выше; Shop-Script 8.1.1 и выше; Web Server (Apache suggested); Database ( MySQLi suggested).

CS-Cart. Требования: PHP 5.3 и выше; PrestaShop 1.4.10 и выше; Web Server (Apache suggested); Database ( MySQLi suggested).

Предыдущая страница
Пример реализации сервера
Следующая страница
Поиск ключа и id кассы в личном кабинете

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Поиск id кассы
Поиск ключа-пароля от кассы
Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Поиск ключа и id кассы в личном кабинете
Поиск ключа и id кассы в личном кабинете
Поиск id кассы

Поиск ключа-пароля от кассы

Предыдущая страница
Плагины для CMS
Следующая страница
Поиск id кассы

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Поиск id кассы
Поиск ключа-пароля от кассы
Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Поиск ключа и id кассы в личном кабинетеПоиск id кассы
Поиск id кассы
Войдите в личный кабинет


В списке всех ваших бизнесов кликните на нужный бизнес.


В бизнесе будут показаны платежи - все чеки по данному бизнесу.


Откройте вкладку «Кассы».


На экране будет показан список касс по выбранному бизнесу.


Найдите нужную вам кассу и справа нажмите на контекстное меню. Появится список доступных функций. В списке нажмите “Скопировать ID”.


Предыдущая страница
Поиск ключа и id кассы в личном кабинете
Следующая страница
Поиск ключа-пароля от кассы

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Поиск id кассы
Поиск ключа-пароля от кассы
Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Поиск ключа и id кассы в личном кабинетеПоиск ключа-пароля от кассы
Поиск ключа-пароля от кассы
Войдите в личный кабинет


В списке всех ваших бизнесов кликните на нужный бизнес.


В бизнесе будут показаны платежи - все чеки по данному бизнесу.


Откройте вкладку «Кассы».


На экране будет показан список касс по выбранному бизнесу.


Кликните на нужную кассу.


На экране появятся все совершенные платежи только по выбранной кассе. Перейдите на вкладку «Настройки».


Здесь вы можете отредактировать данные в своей кассе. Чтобы скопировать ключ, необходимо перейти в раздел «Инструменты разработчика».


Здесь находятся ключи от кассы.
Ключ - используется для приема платежей.

Тестовый ключ - используется для тестирования вашей кассы.

Предыдущая страница
Поиск id кассы
Следующая страница
Песочница

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Поиск id кассы
Поиск ключа-пароля от кассы
Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Песочница
Песочница
О песочнице

Подготовка к тестированию

Тестирование

к сведению
Тестирование на рабочем сервере создает дополнительную нагрузку. Учетные записи, которые связаны с некорректно работающими приложениями, блокируются.

О песочнице
Песочница — среда для безопасного тестирования реализованного Merchant API. Тесты в песочнице помогут проверить взаимодействие реализованного API с Payme Business. Тестирование в песочнице позволяет получить детальное описание возникающих ошибок.

Инициирует тестирование и запускает тесты — разработчик мерчанта. Тестирование проводится с помощью запросов и ответов. Запросы отправляет сервер Payme Business, ответы — сервер мерчанта.

Подготовка к тестированию
Добавьте веб кассу в кабинете мерчанта. После создания веб-кассы, Payme Business выдаст 2 ключа:

ключ для кабинета — key;

ключ для песочницы — TEST_KEY.

Перейдите в песочницу. В песочнице введите Merchant ID (ID веб-кассы) и TEST_KEY.

к сведению
Merchant ID хранится в параметрах разработчика веб-кассы.



к сведению
Важно чтобы в настройках кассы был указан Endpoint URL — веб-адрес биллинга. По этому адресу Payme Business будет посылать запросы.

При создании транзакций в песочнице, важно правильно указать тип счёта:

На накопительный счёт деньги могут поступать неограниченное количество раз. Пример накопительного счёта — счет мобильного оператора;

На одноразовый счёт, деньги могут поступать только 1 раз. Пример одноразового счёта — заказ в интернет магазине.

к сведению
Тестирование инициализации платежа рекомендуется проводить только после успешного завершения тестирования в песочнице: вначале протестируйте инициализацию платежа в песочнице, затем в продакшене.

Веб-адрес песочницы: https://test.paycom.uz

URL отправки чека в песочницу: https://test.paycom.uz

URL отправки чека в продакшн: https://checkout.paycom.uz

Тестирование
Тестирование проводится по 2 сценариям:

Создание и отмена неподтвержденной транзакции

Создание, подтверждение и отмена подтверждённой финансовой транзакции

В первый сценарий включена проверка безопасности, поэтому вначале проводится тестирование по первому сценарию, затем по второму.

к сведению
В платёжном плагине Merchant API уже реализовано, поэтому тестирование платёжного плагина проводится по тем же сценариям.

Создание и отмена неподтвержденной транзакции
Войдите в магазин как покупатель. Добавьте товар в корзину и оплатите заказ с помощью Payme. После оплаты произойдёт автоматический переход в «Песочницу» на страницу создания финансовой транзакции.

Проверьте авторизацию с неверными учетными данными

В разделе «Неверные данные» нажмите на ссылку «Неверная авторизация» и запустите тест.



к сведению
На запросы к реализованным методам, реализованное Merchant API возвращает ответы с ошибкой -32504: «Недостаточно привилегий для выполнения метода».

Проверьте оплату неверной или недопустимой суммой

В разделе «Неверные данные» нажмите на ссылку «Неверная сумма».



В параметрах теста укажите действительный номер заказа, неверную сумму и запустите тест.



к сведению
На запросы к реализованным методам CheckPerformTransaction и CreateTransaction, реализованное Merchant API возвращает ответы с ошибкой -31001: «Неверная сумма».

Проверьте оплату несуществующего счёта

В разделе «Неверные данные» нажмите на ссылку «Несуществующий счёт».



В параметрах теста укажите действительную сумму заказа, неверный номер заказа и запустите тест.



к сведению
На запросы к реализованным методам CheckPerformTransaction и CreateTransaction, реализованное Merchant API возвращает ответы с ошибками -31050 — -31099: «Неверный код заказа».

Проверьте возможность создания финансовой транзакции

к сведению
Проверку возможности создания финансовой транзакции обеспечивает реализованный метод CheckPerformTransaction.

В разделе «Платежные запросы» нажмите на ссылку “CheckPerformTransaction”.



Убедитесь что в парметрах теста присутствует значение парметра Account, сумма оплаты в тийинах и запустите тест.



На запрос к реализованному методу CheckPerformTransaction, реализованное Merchant API возвращает ответ без ошибок.

Создайте транзакцию

к сведению
Создание транзакции обеспечивает реализованный метод CreateTransaction.

В разделе «Платежные запросы» нажмите на ссылку “CreateTransaction”.



Убедитесь что в параметрах запуска теста тип счета «Одноразовый», статус счета «Ожидает оплаты» и запустите тест.



к сведению
Запросы по методам CreateTransaction, PerformTransaction, CancelTransaction посылаются два раза. В случае, если первый запрос даст сбой - второй обязательно пройдет. При повторных вызовах методов CreateTransaction, PerformTransaction, CancelTransaction ответ должен совпадать с ответом из первого запроса.

Реализованное Merchant API возвращает:

на запрос к реализованному методу CheckPerformTransaction — ответ с результатом “allow”: true,;

на запрос к реализованному методу CreateTransaction — ответ без ошибок;

на повторный запрос, к реализованному методу CreateTransaction — ответ без ошибок;

на запрос к реализованному методу CheckTransaction — ответ без ошибок;

на запрос к реализованному методу CreateTransaction c новой транзакцией и состоянием счета «В ожидании оплаты» — ответ с ошибкой -31008: “Невозможно выполнить операцию”.

Отмените неподтвержденную транзакцию

к сведению
Отмену транзакции обеспечивает реализованный метод CancelTransaction.

В разделе «Платежные запросы» нажмите на ссылку “CancelTransaction”.



Убедитесь что в параметрах запуска теста присутствует id транзакции, статус транзакции “1” (транзакция создана) и запустите тест.



к сведению
На запросы к реализованным методам CancelTransaction и CheckTransction, реализованное Merchant API возвращает ответы без ошибок.

Создание, подтверждение и отмена подтвержденной транзакции
Войдите в магазин как покупатель. Добавьте товар в корзину и оплатите заказ с помощью Payme. После оплаты произойдет автоматический переход в «Песочницу» на страницу создания финансовой транзакции.

Проверьте возможность создания финансовой транзакции

к сведению
Проверку возможности создания финансовой транзакции обеспечивает реализованный метод CheckPerformTransaction.

В разделе «Платежные запросы» нажмите на ссылку “CheckPerformTransaction”.



Убедитесь что в парметрах теста присутствует значение парметра Account, сумма оплаты в тийинах и запустите тест.



На запрос к реализованному методу CheckPerformTransaction, реализованное Merchant API возвращает ответ без ошибок.

Создайте транзакцию

к сведению
Создание транзакции обеспечивает реализованный метод CreateTransaction.

В разделе «Платежные запросы» нажмите на ссылку “CreateTransaction”.



Убедитесь что в параметрах запуска теста тип счета «Одноразовый», статус счета «Ожидает оплаты» и запустите тест.



Реализованное Merchant API возвращает:

на запрос к реализованному методу CheckPerformTransaction — ответ с результатом “allow”: true,;

на запрос к реализованному методу CreateTransaction — ответ без ошибок;

на повторный запрос, к реализованному методу CreateTransaction — ответ без ошибок;

на запрос к реализованному методу CheckTransaction — ответ без ошибок;

на запрос к реализованному методу CreateTransaction c новой транзакцией и состоянием счета «В ожидании оплаты» — ответ с ошибкой -31008: “Невозможно выполнить операцию”.

Подтвердите транзакцию

к сведению
Подтверждение транзакции обеспечивает реализованный метод PerformTransaction.

В разделе «Платежные запросы» нажмите на ссылку “PerformTransaction”.



Убедитесь что в параметрах запуска теста присутствует id транзакции, статус транзакции “1” (создана) и запустите тест.



Реализованное Merchant API возвращает ответ без ошибок:

на запрос к реализованному методу PerformTransaction;

на повторный запрос, к реализованному методу PerformTransaction;

на запрос к реализованному методу CheckTransaction.

Отмените подтвержденную транзакцию

к сведению
Отмену транзакции обеспечивает реализованный метод CancelTransaction.

В разделе «Платежные запросы» нажмите на ссылку “CancelTransaction”.



Убедитесь что в параметрах запуска теста присутствует id транзакции, статус транзакции “1” (транзакция создана) и запустите тест.



к сведению
На запросы к реализованным методам CancelTransaction и CheckTransction, реализованное Merchant API возвращает ответы без ошибок.

Предыдущая страница
Поиск ключа-пароля от кассы
Следующая страница
Интеграция с мобильным приложением


Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Поиск id кассы
Поиск ключа-пароля от кассы
Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Интеграция с мобильным приложением
Интеграция с мобильным приложением
Чтобы интегрировать Payme Business с мобильным приложением, подключите к мобильному приложению библиотеку Payme Business Android SDK и реализуйте методы работы с пластиковыми картами и чеком для серверной части приложения мерчанта из Subscribe API.

В библиотеке Payme Business Android SDK — реализован пользовательский интерфейс и все методы работы с пластиковыми картами для клиентской части из Subscribe API.

Последняя версия библиотеки Payme Business Android SDK на bintray

Подключение библиотеки

Обработка результата

Тестирование в песочнице

Пользовательский интерфейс

Работа в мобильном приложении

Предыдущая страница
Песочница
Следующая страница
Подключение библиотеки

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Поиск id кассы
Поиск ключа-пароля от кассы
Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Интеграция с мобильным приложениемПодключение библиотеки
Подключение библиотеки
Добавьте в app build.gradle:
dependencies {
   compile 'uz.paycom:payment:$last version' 
}

Встройте в приложение вызов на оплату:
   @Override public void onClick(View v) {
   Intent intent = new Intent(YourActivity.this, PaymentActivity.class);
   intent.putExtra(EXTRA_ID, xAuth); //Ваш ID мерчанта
   final Double sum = Double.valueOf(activityTestSum.getText().toString());
   intent.putExtra(EXTRA_AMOUNT, sum); //Сумма оплаты
   intent.putExtra(EXTRA_SAVE, activityTestMultiple.isChecked()); //Сохранить для многократной оплаты?
   intent.putExtra(EXTRA_LANG, "RU"); //Язык "RU" или "UZ"
   PaycomSandBox.setEnabled(true); //true для тестовой площадки, по умолчанию false
   startActivityForResult(intent, 0);
   }


Предыдущая страница
Интеграция с мобильным приложением
Следующая страница
Обработка результата

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Поиск id кассы
Поиск ключа-пароля от кассы
Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Интеграция с мобильным приложениемОбработка результата
Обработка результата
После вызова оплаты: покупатель вводит данные платежа, Payme Business SDK — возвращает токен для совершения платежа. Токен передаётся в backend мобильного приложения.

Пример

@Override
  protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (resultCode == RESULT_OK) {
      Result result = data.getParcelableExtra(EXTRA_RESULT);
      Log.d(TAG, result.toString());
    } else if (resultCode == RESULT_CANCELED) {
      Log.d(TAG, "Payment canceled"); //Произошла отмена оплаты
    }
  }

Result содержит поля:

number: string // Маскированный номер карты;

expire: string // Срок действия карты;

token: string // Токен для совершения платежа. Токен передаётся в backend мобильного приложения и используется для оплаты чека.

recurrent: boolean // Возможность проведения повторных платежей. Если false — возможна только одна транзакция с обязательным указанием точно такой же суммы.

verify: boolean // Была ли пройдена идентификация владельца карты по смс.

Предыдущая страница
Подключение библиотеки
Следующая страница
Тестирование в песочнице

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Поиск id кассы
Поиск ключа-пароля от кассы
Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Интеграция с мобильным приложениемТестирование в песочнице
Тестирование в песочнице
СМС-код безопасности для всех тестовых карт всегда: 666666

Тестовые карты

Номер	Срок действия карты (Expired)	Комментарий
8600 0609 2109 0842	03/99	SMS-информирование не подключено.
3333 3364 1580 4657	03/99	Срок действия карты истек.
4444 4459 8745 9073	03/99	Карта заблокирована.
8600 1434 1777 0323	03/99	Неизвестная системная ошибка.
8600 1343 0184 9596	03/99	Симуляция задержки обработки на 10 секунд. Заканчивается ошибкой.
8600 4954 7331 6478	03/99	
8600 0691 9540 6311	03/99	
Предыдущая страница
Обработка результата
Следующая страница
Пользовательский интерфейс

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Поиск id кассы
Поиск ключа-пароля от кассы
Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Интеграция с мобильным приложениемПользовательский интерфейс
Пользовательский интерфейс


Предыдущая страница
Тестирование в песочнице
Следующая страница
Работа в мобильном приложении

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Поиск id кассы
Поиск ключа-пароля от кассы
Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Ресурсы
Техническая поддержка
Интеграция с мобильным приложениемРабота в мобильном приложении
Работа в мобильном приложении
В мобильном приложении поставщика возможно проводить оплаты за услуги или товар поставщика в соответствии с созданным алгоритмом.

Порядок оплаты детально показан в разделе Взаимодействие протоколов Merchant API и Subscribe API.

Предыдущая страница
Пользовательский интерфейс
Следующая страница
Телеграм бот

Перейти к основному содержимому
Payme Logo
Русский

Поиск
ctrl
K
Введение
Настройка взаимодействия
Протокол Merchant API

Формат запроса
Формат ответа
Общие ошибки
Схема взаимодействия
Методы Merchant API

CheckPerformTransaction
CreateTransaction
PerformTransaction
CancelTransaction
CheckTransaction
GetStatement
SetFiscalData
Ошибки (ERRORS)
Типы данных
Протокол Subscribe API
Методы Subscribe API

cards.create
cards.get_verify_code
cards.verify
cards.check
cards.remove
receipts.create
receipts.pay
receipts.send
receipts.cancel
receipts.check
receipts.get
receipts.get_all
receipts.set_fiscal_data
Состояния чека
Холдирование
Взаимодействие протоколов Merchant API и Subscribe API
Инициализация платежей

Генерация кнопки оплаты и QR-кода
Отправка чека по методу POST
Отправка чека по методу GET
Ошибки отправки чека
Пример реализации сервера
Плагины для CMS
Поиск ключа и id кассы в личном кабинете

Поиск id кассы
Поиск ключа-пароля от кассы
Песочница
Интеграция с мобильным приложением

Подключение библиотеки
Обработка результата
Тестирование в песочнице
Пользовательский интерфейс
Работа в мобильном приложении
Телеграм бот

Диаграмма процесса оплаты
Добавление кассы для бота
Подключение бота
Ресурсы
Техническая поддержка
Телеграм бот
Телеграм бот
Создание бота

BotFather — это Телеграм-бот, который помогает создавать другие Телеграм-боты. Чтобы начать «общение» с BotFather, добавьте бот в список контактов Телеграм и нажмите кнопку Start — появится список команд.



Название бота

Чтобы создать свой Телеграм-бот, отправьте BotFather команду /newbot — BotFather предложит дать название боту. В названии бота, используйте только латинские буквы и цифры. Между буквами и цифрами допускается оставлять пробелы.



Имя бота

Придумайте имя для вашего бота. Имя бота — это адрес вашего бота в формате: telegram.me/username. Имя должно всегда содержать в конце слово bot. Например, MynewBot или Mynew_bot. Пробелы в имени бота не допускаются. Если кто-то уже использует такое же имя, BotFather предложит придумать другое. После назначения имени, BotFather сгенерирует токен — идентификатор для доступа к API Telegram.



Фото профиля

Чтобы загрузить логотип компании, отправьте BotFather команду /setuserpic — BotFather предложит выбрать бот. Выберите бот и загрузите логотип.



Описание бота

Описание бота отображается в профиле Телеграм рядом со ссылкой на ваш бот. Чтобы добавить описание бота, отправьте BotFather команду /setabouttext — BotFather предложит выбрать бот. Выберите бот и добавьте описание.



Возможности бота

Чтобы вначале беседы с вашим ботом пользователи увидели его возможности — опишите их. Отправьте BotFather команду * */setdescription** — BotFather предложит выбрать бот. Выберите бот и добавьте описание возможностей.



Предыдущая страница
Работа в мобильном приложении
Следующая страница
Диаграмма процесса оплаты

